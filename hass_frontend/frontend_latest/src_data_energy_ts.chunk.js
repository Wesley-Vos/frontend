"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkhome_assistant_frontend"] = self["webpackChunkhome_assistant_frontend"] || []).push([["src_data_energy_ts"],{

/***/ "./src/common/string/compare.ts":
/*!**************************************!*\
  !*** ./src/common/string/compare.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"stringCompare\": () => (/* binding */ stringCompare),\n/* harmony export */   \"caseInsensitiveStringCompare\": () => (/* binding */ caseInsensitiveStringCompare)\n/* harmony export */ });\nconst stringCompare = (a, b) => {\n  if (a < b) {\n    return -1;\n  }\n\n  if (a > b) {\n    return 1;\n  }\n\n  return 0;\n};\nconst caseInsensitiveStringCompare = (a, b) => stringCompare(a.toLowerCase(), b.toLowerCase());//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tbW9uL3N0cmluZy9jb21wYXJlLnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2NvbW1vbi9zdHJpbmcvY29tcGFyZS50cz83MGU1Il0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBzdHJpbmdDb21wYXJlID0gKGE6IHN0cmluZywgYjogc3RyaW5nKSA9PiB7XG4gIGlmIChhIDwgYikge1xuICAgIHJldHVybiAtMTtcbiAgfVxuICBpZiAoYSA+IGIpIHtcbiAgICByZXR1cm4gMTtcbiAgfVxuXG4gIHJldHVybiAwO1xufTtcblxuZXhwb3J0IGNvbnN0IGNhc2VJbnNlbnNpdGl2ZVN0cmluZ0NvbXBhcmUgPSAoYTogc3RyaW5nLCBiOiBzdHJpbmcpID0+XG4gIHN0cmluZ0NvbXBhcmUoYS50b0xvd2VyQ2FzZSgpLCBiLnRvTG93ZXJDYXNlKCkpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/common/string/compare.ts\n");

/***/ }),

/***/ "./src/common/util/group-by.ts":
/*!*************************************!*\
  !*** ./src/common/util/group-by.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"groupBy\": () => (/* binding */ groupBy)\n/* harmony export */ });\nconst groupBy = (list, keySelector) => {\n  const result = {};\n\n  for (const item of list) {\n    const key = keySelector(item);\n\n    if (key in result) {\n      result[key].push(item);\n    } else {\n      result[key] = [item];\n    }\n  }\n\n  return result;\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tbW9uL3V0aWwvZ3JvdXAtYnkudHMuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBSUE7O0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2NvbW1vbi91dGlsL2dyb3VwLWJ5LnRzP2Y4ZTAiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGdyb3VwQnkgPSA8VD4oXG4gIGxpc3Q6IFRbXSxcbiAga2V5U2VsZWN0b3I6IChpdGVtOiBUKSA9PiBzdHJpbmdcbik6IHsgW2tleTogc3RyaW5nXTogVFtdIH0gPT4ge1xuICBjb25zdCByZXN1bHQgPSB7fTtcbiAgZm9yIChjb25zdCBpdGVtIG9mIGxpc3QpIHtcbiAgICBjb25zdCBrZXkgPSBrZXlTZWxlY3RvcihpdGVtKTtcbiAgICBpZiAoa2V5IGluIHJlc3VsdCkge1xuICAgICAgcmVzdWx0W2tleV0ucHVzaChpdGVtKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0W2tleV0gPSBbaXRlbV07XG4gICAgfVxuICB9XG4gIHJldHVybiByZXN1bHQ7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/common/util/group-by.ts\n");

/***/ }),

/***/ "./src/common/util/subscribe-one.ts":
/*!******************************************!*\
  !*** ./src/common/util/subscribe-one.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"subscribeOne\": () => (/* binding */ subscribeOne)\n/* harmony export */ });\nconst subscribeOne = async (conn, subscribe) => new Promise(resolve => {\n  const unsub = subscribe(conn, items => {\n    unsub();\n    resolve(items);\n  });\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvY29tbW9uL3V0aWwvc3Vic2NyaWJlLW9uZS50cy5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBRUE7QUFRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaG9tZS1hc3Npc3RhbnQtZnJvbnRlbmQvLi9zcmMvY29tbW9uL3V0aWwvc3Vic2NyaWJlLW9uZS50cz83NzAxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbm5lY3Rpb24sIFVuc3Vic2NyaWJlRnVuYyB9IGZyb20gXCJob21lLWFzc2lzdGFudC1qcy13ZWJzb2NrZXRcIjtcblxuZXhwb3J0IGNvbnN0IHN1YnNjcmliZU9uZSA9IGFzeW5jIDxUPihcbiAgY29ubjogQ29ubmVjdGlvbixcbiAgc3Vic2NyaWJlOiAoXG4gICAgY29ubjI6IENvbm5lY3Rpb24sXG4gICAgb25DaGFuZ2U6IChpdGVtczogVCkgPT4gdm9pZFxuICApID0+IFVuc3Vic2NyaWJlRnVuY1xuKSA9PlxuICBuZXcgUHJvbWlzZTxUPigocmVzb2x2ZSkgPT4ge1xuICAgIGNvbnN0IHVuc3ViID0gc3Vic2NyaWJlKGNvbm4sIChpdGVtcykgPT4ge1xuICAgICAgdW5zdWIoKTtcbiAgICAgIHJlc29sdmUoaXRlbXMpO1xuICAgIH0pO1xuICB9KTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/common/util/subscribe-one.ts\n");

/***/ }),

/***/ "./src/data/config_entries.ts":
/*!************************************!*\
  !*** ./src/data/config_entries.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"ERROR_STATES\": () => (/* binding */ ERROR_STATES),\n/* harmony export */   \"getConfigEntries\": () => (/* binding */ getConfigEntries),\n/* harmony export */   \"updateConfigEntry\": () => (/* binding */ updateConfigEntry),\n/* harmony export */   \"deleteConfigEntry\": () => (/* binding */ deleteConfigEntry),\n/* harmony export */   \"reloadConfigEntry\": () => (/* binding */ reloadConfigEntry),\n/* harmony export */   \"disableConfigEntry\": () => (/* binding */ disableConfigEntry),\n/* harmony export */   \"enableConfigEntry\": () => (/* binding */ enableConfigEntry)\n/* harmony export */ });\nconst ERROR_STATES = [\"migration_error\", \"setup_error\", \"setup_retry\"];\nconst getConfigEntries = (hass, filters) => {\n  const params = new URLSearchParams();\n\n  if (filters) {\n    if (filters.type) {\n      params.append(\"type\", filters.type);\n    }\n\n    if (filters.domain) {\n      params.append(\"domain\", filters.domain);\n    }\n  }\n\n  return hass.callApi(\"GET\", `config/config_entries/entry?${params.toString()}`);\n};\nconst updateConfigEntry = (hass, configEntryId, updatedValues) => hass.callWS({\n  type: \"config_entries/update\",\n  entry_id: configEntryId,\n  ...updatedValues\n});\nconst deleteConfigEntry = (hass, configEntryId) => hass.callApi(\"DELETE\", `config/config_entries/entry/${configEntryId}`);\nconst reloadConfigEntry = (hass, configEntryId) => hass.callApi(\"POST\", `config/config_entries/entry/${configEntryId}/reload`);\nconst disableConfigEntry = (hass, configEntryId) => hass.callWS({\n  type: \"config_entries/disable\",\n  entry_id: configEntryId,\n  disabled_by: \"user\"\n});\nconst enableConfigEntry = (hass, configEntryId) => hass.callWS({\n  type: \"config_entries/disable\",\n  entry_id: configEntryId,\n  disabled_by: null\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZGF0YS9jb25maWdfZW50cmllcy50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBOEJBO0FBTUE7QUFJQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUlBO0FBRUE7QUFNQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBS0E7QUFTQTtBQUtBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFJQTtBQUNBO0FBQ0E7QUFIQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2RhdGEvY29uZmlnX2VudHJpZXMudHM/MmYzMSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIb21lQXNzaXN0YW50IH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ29uZmlnRW50cnkge1xuICBlbnRyeV9pZDogc3RyaW5nO1xuICBkb21haW46IHN0cmluZztcbiAgdGl0bGU6IHN0cmluZztcbiAgc291cmNlOiBzdHJpbmc7XG4gIHN0YXRlOlxuICAgIHwgXCJsb2FkZWRcIlxuICAgIHwgXCJzZXR1cF9lcnJvclwiXG4gICAgfCBcIm1pZ3JhdGlvbl9lcnJvclwiXG4gICAgfCBcInNldHVwX3JldHJ5XCJcbiAgICB8IFwibm90X2xvYWRlZFwiXG4gICAgfCBcImZhaWxlZF91bmxvYWRcIjtcbiAgc3VwcG9ydHNfb3B0aW9uczogYm9vbGVhbjtcbiAgc3VwcG9ydHNfcmVtb3ZlX2RldmljZTogYm9vbGVhbjtcbiAgc3VwcG9ydHNfdW5sb2FkOiBib29sZWFuO1xuICBwcmVmX2Rpc2FibGVfbmV3X2VudGl0aWVzOiBib29sZWFuO1xuICBwcmVmX2Rpc2FibGVfcG9sbGluZzogYm9vbGVhbjtcbiAgZGlzYWJsZWRfYnk6IFwidXNlclwiIHwgbnVsbDtcbiAgcmVhc29uOiBzdHJpbmcgfCBudWxsO1xufVxuXG5leHBvcnQgdHlwZSBDb25maWdFbnRyeU11dGFibGVQYXJhbXMgPSBQYXJ0aWFsPFxuICBQaWNrPFxuICAgIENvbmZpZ0VudHJ5LFxuICAgIFwidGl0bGVcIiB8IFwicHJlZl9kaXNhYmxlX25ld19lbnRpdGllc1wiIHwgXCJwcmVmX2Rpc2FibGVfcG9sbGluZ1wiXG4gID5cbj47XG5cbmV4cG9ydCBjb25zdCBFUlJPUl9TVEFURVM6IENvbmZpZ0VudHJ5W1wic3RhdGVcIl1bXSA9IFtcbiAgXCJtaWdyYXRpb25fZXJyb3JcIixcbiAgXCJzZXR1cF9lcnJvclwiLFxuICBcInNldHVwX3JldHJ5XCIsXG5dO1xuXG5leHBvcnQgY29uc3QgZ2V0Q29uZmlnRW50cmllcyA9IChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgZmlsdGVycz86IHsgdHlwZT86IFwiaGVscGVyXCIgfCBcImludGVncmF0aW9uXCI7IGRvbWFpbj86IHN0cmluZyB9XG4pOiBQcm9taXNlPENvbmZpZ0VudHJ5W10+ID0+IHtcbiAgY29uc3QgcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICBpZiAoZmlsdGVycykge1xuICAgIGlmIChmaWx0ZXJzLnR5cGUpIHtcbiAgICAgIHBhcmFtcy5hcHBlbmQoXCJ0eXBlXCIsIGZpbHRlcnMudHlwZSk7XG4gICAgfVxuICAgIGlmIChmaWx0ZXJzLmRvbWFpbikge1xuICAgICAgcGFyYW1zLmFwcGVuZChcImRvbWFpblwiLCBmaWx0ZXJzLmRvbWFpbik7XG4gICAgfVxuICB9XG4gIHJldHVybiBoYXNzLmNhbGxBcGk8Q29uZmlnRW50cnlbXT4oXG4gICAgXCJHRVRcIixcbiAgICBgY29uZmlnL2NvbmZpZ19lbnRyaWVzL2VudHJ5PyR7cGFyYW1zLnRvU3RyaW5nKCl9YFxuICApO1xufTtcblxuZXhwb3J0IGNvbnN0IHVwZGF0ZUNvbmZpZ0VudHJ5ID0gKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBjb25maWdFbnRyeUlkOiBzdHJpbmcsXG4gIHVwZGF0ZWRWYWx1ZXM6IENvbmZpZ0VudHJ5TXV0YWJsZVBhcmFtc1xuKSA9PlxuICBoYXNzLmNhbGxXUzx7IHJlcXVpcmVfcmVzdGFydDogYm9vbGVhbjsgY29uZmlnX2VudHJ5OiBDb25maWdFbnRyeSB9Pih7XG4gICAgdHlwZTogXCJjb25maWdfZW50cmllcy91cGRhdGVcIixcbiAgICBlbnRyeV9pZDogY29uZmlnRW50cnlJZCxcbiAgICAuLi51cGRhdGVkVmFsdWVzLFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IGRlbGV0ZUNvbmZpZ0VudHJ5ID0gKGhhc3M6IEhvbWVBc3Npc3RhbnQsIGNvbmZpZ0VudHJ5SWQ6IHN0cmluZykgPT5cbiAgaGFzcy5jYWxsQXBpPHtcbiAgICByZXF1aXJlX3Jlc3RhcnQ6IGJvb2xlYW47XG4gIH0+KFwiREVMRVRFXCIsIGBjb25maWcvY29uZmlnX2VudHJpZXMvZW50cnkvJHtjb25maWdFbnRyeUlkfWApO1xuXG5leHBvcnQgY29uc3QgcmVsb2FkQ29uZmlnRW50cnkgPSAoaGFzczogSG9tZUFzc2lzdGFudCwgY29uZmlnRW50cnlJZDogc3RyaW5nKSA9PlxuICBoYXNzLmNhbGxBcGk8e1xuICAgIHJlcXVpcmVfcmVzdGFydDogYm9vbGVhbjtcbiAgfT4oXCJQT1NUXCIsIGBjb25maWcvY29uZmlnX2VudHJpZXMvZW50cnkvJHtjb25maWdFbnRyeUlkfS9yZWxvYWRgKTtcblxuZXhwb3J0IGludGVyZmFjZSBEaXNhYmxlQ29uZmlnRW50cnlSZXN1bHQge1xuICByZXF1aXJlX3Jlc3RhcnQ6IGJvb2xlYW47XG59XG5cbmV4cG9ydCBjb25zdCBkaXNhYmxlQ29uZmlnRW50cnkgPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIGNvbmZpZ0VudHJ5SWQ6IHN0cmluZ1xuKSA9PlxuICBoYXNzLmNhbGxXUzxEaXNhYmxlQ29uZmlnRW50cnlSZXN1bHQ+KHtcbiAgICB0eXBlOiBcImNvbmZpZ19lbnRyaWVzL2Rpc2FibGVcIixcbiAgICBlbnRyeV9pZDogY29uZmlnRW50cnlJZCxcbiAgICBkaXNhYmxlZF9ieTogXCJ1c2VyXCIsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgZW5hYmxlQ29uZmlnRW50cnkgPSAoaGFzczogSG9tZUFzc2lzdGFudCwgY29uZmlnRW50cnlJZDogc3RyaW5nKSA9PlxuICBoYXNzLmNhbGxXUzx7XG4gICAgcmVxdWlyZV9yZXN0YXJ0OiBib29sZWFuO1xuICB9Pih7XG4gICAgdHlwZTogXCJjb25maWdfZW50cmllcy9kaXNhYmxlXCIsXG4gICAgZW50cnlfaWQ6IGNvbmZpZ0VudHJ5SWQsXG4gICAgZGlzYWJsZWRfYnk6IG51bGwsXG4gIH0pO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/data/config_entries.ts\n");

/***/ }),

/***/ "./src/data/energy.ts":
/*!****************************!*\
  !*** ./src/data/energy.ts ***!
  \****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__) => {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"emptyFlowFromGridSourceEnergyPreference\": () => (/* binding */ emptyFlowFromGridSourceEnergyPreference),\n/* harmony export */   \"emptyFlowToGridSourceEnergyPreference\": () => (/* binding */ emptyFlowToGridSourceEnergyPreference),\n/* harmony export */   \"emptyGridSourceEnergyPreference\": () => (/* binding */ emptyGridSourceEnergyPreference),\n/* harmony export */   \"emptySolarEnergyPreference\": () => (/* binding */ emptySolarEnergyPreference),\n/* harmony export */   \"emptyBatteryEnergyPreference\": () => (/* binding */ emptyBatteryEnergyPreference),\n/* harmony export */   \"emptyGasEnergyPreference\": () => (/* binding */ emptyGasEnergyPreference),\n/* harmony export */   \"getEnergyInfo\": () => (/* binding */ getEnergyInfo),\n/* harmony export */   \"getEnergyPreferenceValidation\": () => (/* binding */ getEnergyPreferenceValidation),\n/* harmony export */   \"getEnergyPreferences\": () => (/* binding */ getEnergyPreferences),\n/* harmony export */   \"saveEnergyPreferences\": () => (/* binding */ saveEnergyPreferences),\n/* harmony export */   \"getFossilEnergyConsumption\": () => (/* binding */ getFossilEnergyConsumption),\n/* harmony export */   \"energySourcesByType\": () => (/* binding */ energySourcesByType),\n/* harmony export */   \"getEnergyDataCollection\": () => (/* binding */ getEnergyDataCollection),\n/* harmony export */   \"getEnergySolarForecasts\": () => (/* binding */ getEnergySolarForecasts),\n/* harmony export */   \"ENERGY_GAS_VOLUME_UNITS\": () => (/* binding */ ENERGY_GAS_VOLUME_UNITS),\n/* harmony export */   \"ENERGY_GAS_ENERGY_UNITS\": () => (/* binding */ ENERGY_GAS_ENERGY_UNITS),\n/* harmony export */   \"ENERGY_GAS_UNITS\": () => (/* binding */ ENERGY_GAS_UNITS),\n/* harmony export */   \"getEnergyGasUnitCategory\": () => (/* binding */ getEnergyGasUnitCategory),\n/* harmony export */   \"getEnergyGasUnit\": () => (/* binding */ getEnergyGasUnit)\n/* harmony export */ });\n/* harmony import */ var date_fns__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! date-fns */ \"./node_modules/date-fns/esm/differenceInDays/index.js\");\n/* harmony import */ var date_fns__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! date-fns */ \"./node_modules/date-fns/esm/addHours/index.js\");\n/* harmony import */ var date_fns__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! date-fns */ \"./node_modules/date-fns/esm/startOfToday/index.js\");\n/* harmony import */ var date_fns__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! date-fns */ \"./node_modules/date-fns/esm/startOfYesterday/index.js\");\n/* harmony import */ var date_fns__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! date-fns */ \"./node_modules/date-fns/esm/endOfToday/index.js\");\n/* harmony import */ var date_fns__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! date-fns */ \"./node_modules/date-fns/esm/endOfYesterday/index.js\");\n/* harmony import */ var home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! home-assistant-js-websocket */ \"./node_modules/home-assistant-js-websocket/dist/collection.js\");\n/* harmony import */ var _common_util_group_by__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/util/group-by */ \"./src/common/util/group-by.ts\");\n/* harmony import */ var _common_util_subscribe_one__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/util/subscribe-one */ \"./src/common/util/subscribe-one.ts\");\n/* harmony import */ var _config_entries__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./config_entries */ \"./src/data/config_entries.ts\");\n/* harmony import */ var _entity_registry__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./entity_registry */ \"./src/data/entity_registry.ts\");\n/* harmony import */ var _history__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./history */ \"./src/data/history.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_history__WEBPACK_IMPORTED_MODULE_4__]);\n_history__WEBPACK_IMPORTED_MODULE_4__ = (__webpack_async_dependencies__.then ? await __webpack_async_dependencies__ : __webpack_async_dependencies__)[0];\n\n\n\n\n\n\n\nconst energyCollectionKeys = [];\nconst emptyFlowFromGridSourceEnergyPreference = () => ({\n  stat_energy_from: \"\",\n  stat_cost: null,\n  entity_energy_from: null,\n  entity_energy_price: null,\n  number_energy_price: null\n});\nconst emptyFlowToGridSourceEnergyPreference = () => ({\n  stat_energy_to: \"\",\n  stat_compensation: null,\n  entity_energy_to: null,\n  entity_energy_price: null,\n  number_energy_price: null\n});\nconst emptyGridSourceEnergyPreference = () => ({\n  type: \"grid\",\n  flow_from: [],\n  flow_to: [],\n  cost_adjustment_day: 0\n});\nconst emptySolarEnergyPreference = () => ({\n  type: \"solar\",\n  stat_energy_from: \"\",\n  config_entry_solar_forecast: null\n});\nconst emptyBatteryEnergyPreference = () => ({\n  type: \"battery\",\n  stat_energy_from: \"\",\n  stat_energy_to: \"\"\n});\nconst emptyGasEnergyPreference = () => ({\n  type: \"gas\",\n  stat_energy_from: \"\",\n  stat_cost: null,\n  entity_energy_from: null,\n  entity_energy_price: null,\n  number_energy_price: null\n});\nconst getEnergyInfo = hass => hass.callWS({\n  type: \"energy/info\"\n});\nconst getEnergyPreferenceValidation = hass => hass.callWS({\n  type: \"energy/validate\"\n});\nconst getEnergyPreferences = hass => hass.callWS({\n  type: \"energy/get_prefs\"\n});\nconst saveEnergyPreferences = async (hass, prefs) => {\n  const newPrefs = hass.callWS({\n    type: \"energy/save_prefs\",\n    ...prefs\n  });\n  clearEnergyCollectionPreferences(hass);\n  return newPrefs;\n};\nconst getFossilEnergyConsumption = async (hass, startTime, energy_statistic_ids, co2_statistic_id, endTime, period = \"hour\") => hass.callWS({\n  type: \"energy/fossil_energy_consumption\",\n  start_time: startTime.toISOString(),\n  end_time: endTime === null || endTime === void 0 ? void 0 : endTime.toISOString(),\n  energy_statistic_ids,\n  co2_statistic_id,\n  period\n});\nconst energySourcesByType = prefs => (0,_common_util_group_by__WEBPACK_IMPORTED_MODULE_0__.groupBy)(prefs.energy_sources, item => item.type);\n\nconst getEnergyData = async (hass, prefs, start, end) => {\n  const [configEntries, entityRegistryEntries, info] = await Promise.all([(0,_config_entries__WEBPACK_IMPORTED_MODULE_2__.getConfigEntries)(hass, {\n    domain: \"co2signal\"\n  }), (0,_common_util_subscribe_one__WEBPACK_IMPORTED_MODULE_1__.subscribeOne)(hass.connection, _entity_registry__WEBPACK_IMPORTED_MODULE_3__.subscribeEntityRegistry), getEnergyInfo(hass)]);\n  const co2SignalConfigEntry = configEntries.length ? configEntries[0] : undefined;\n  let co2SignalEntity;\n\n  if (co2SignalConfigEntry) {\n    for (const entry of entityRegistryEntries) {\n      if (entry.config_entry_id !== co2SignalConfigEntry.entry_id) {\n        continue;\n      } // The integration offers 2 entities. We want the % one.\n\n\n      const co2State = hass.states[entry.entity_id];\n\n      if (!co2State || co2State.attributes.unit_of_measurement !== \"%\") {\n        continue;\n      }\n\n      co2SignalEntity = co2State.entity_id;\n      break;\n    }\n  }\n\n  const consumptionStatIDs = [];\n  const statIDs = [];\n  const gasSources = prefs.energy_sources.filter(source => source.type === \"gas\");\n  const gasStatisticIdsWithMeta = await (0,_history__WEBPACK_IMPORTED_MODULE_4__.getStatisticMetadata)(hass, gasSources.map(source => source.stat_energy_from));\n\n  for (const source of prefs.energy_sources) {\n    if (source.type === \"solar\") {\n      statIDs.push(source.stat_energy_from);\n      continue;\n    }\n\n    if (source.type === \"gas\") {\n      statIDs.push(source.stat_energy_from);\n      const entity = hass.states[source.stat_energy_from];\n\n      if (!entity) {\n        for (const statisticIdWithMeta of gasStatisticIdsWithMeta) {\n          if ((statisticIdWithMeta === null || statisticIdWithMeta === void 0 ? void 0 : statisticIdWithMeta.statistic_id) === source.stat_energy_from && statisticIdWithMeta !== null && statisticIdWithMeta !== void 0 && statisticIdWithMeta.unit_of_measurement) {\n            source.unit_of_measurement = (statisticIdWithMeta === null || statisticIdWithMeta === void 0 ? void 0 : statisticIdWithMeta.unit_of_measurement) === \"Wh\" ? \"kWh\" : statisticIdWithMeta === null || statisticIdWithMeta === void 0 ? void 0 : statisticIdWithMeta.unit_of_measurement;\n          }\n        }\n      }\n\n      if (source.stat_cost) {\n        statIDs.push(source.stat_cost);\n      }\n\n      const costStatId = info.cost_sensors[source.stat_energy_from];\n\n      if (costStatId) {\n        statIDs.push(costStatId);\n      }\n\n      continue;\n    }\n\n    if (source.type === \"battery\") {\n      statIDs.push(source.stat_energy_from);\n      statIDs.push(source.stat_energy_to);\n      continue;\n    } // grid source\n\n\n    for (const flowFrom of source.flow_from) {\n      consumptionStatIDs.push(flowFrom.stat_energy_from);\n      statIDs.push(flowFrom.stat_energy_from);\n\n      if (flowFrom.stat_cost) {\n        statIDs.push(flowFrom.stat_cost);\n      }\n\n      const costStatId = info.cost_sensors[flowFrom.stat_energy_from];\n\n      if (costStatId) {\n        statIDs.push(costStatId);\n      }\n    }\n\n    for (const flowTo of source.flow_to) {\n      statIDs.push(flowTo.stat_energy_to);\n\n      if (flowTo.stat_compensation) {\n        statIDs.push(flowTo.stat_compensation);\n      }\n\n      const costStatId = info.cost_sensors[flowTo.stat_energy_to];\n\n      if (costStatId) {\n        statIDs.push(costStatId);\n      }\n    }\n  }\n\n  const dayDifference = (0,date_fns__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(end || new Date(), start); // Subtract 1 hour from start to get starting point data\n\n  const startMinHour = (0,date_fns__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(start, -1);\n  const stats = await (0,_history__WEBPACK_IMPORTED_MODULE_4__.fetchStatistics)(hass, startMinHour, end, statIDs, dayDifference > 35 ? \"month\" : dayDifference > 2 ? \"day\" : \"hour\");\n  let fossilEnergyConsumption;\n\n  if (co2SignalEntity !== undefined) {\n    fossilEnergyConsumption = await getFossilEnergyConsumption(hass, start, consumptionStatIDs, co2SignalEntity, end, dayDifference > 35 ? \"month\" : dayDifference > 2 ? \"day\" : \"hour\");\n  }\n\n  Object.values(stats).forEach(stat => {\n    // if the start of the first value is after the requested period, we have the first data point, and should add a zero point\n    if (stat.length && new Date(stat[0].start) > startMinHour) {\n      stat.unshift({ ...stat[0],\n        start: startMinHour.toISOString(),\n        end: startMinHour.toISOString(),\n        sum: 0,\n        state: 0\n      });\n    }\n  });\n  const data = {\n    start,\n    end,\n    info,\n    prefs,\n    stats,\n    co2SignalConfigEntry,\n    co2SignalEntity,\n    fossilEnergyConsumption\n  };\n  return data;\n};\n\nconst clearEnergyCollectionPreferences = hass => {\n  energyCollectionKeys.forEach(key => {\n    const energyCollection = getEnergyDataCollection(hass, {\n      key\n    });\n    energyCollection.clearPrefs();\n\n    if (energyCollection._active) {\n      energyCollection.refresh();\n    }\n  });\n};\n\nconst getEnergyDataCollection = (hass, options = {}) => {\n  let key = \"_energy\";\n\n  if (options.key) {\n    if (!options.key.startsWith(\"energy_\")) {\n      throw new Error(\"Key need to start with energy_\");\n    }\n\n    key = `_${options.key}`;\n  }\n\n  if (hass.connection[key]) {\n    return hass.connection[key];\n  }\n\n  energyCollectionKeys.push(options.key);\n  const collection = (0,home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_7__.getCollection)(hass.connection, key, async () => {\n    if (!collection.prefs) {\n      // This will raise if not found.\n      // Detect by checking `e.code === \"not_found\"\n      collection.prefs = await getEnergyPreferences(hass);\n    }\n\n    if (collection._refreshTimeout) {\n      clearTimeout(collection._refreshTimeout);\n    }\n\n    if (collection._active && (!collection.end || collection.end > new Date())) {\n      // The stats are created every hour\n      // Schedule a refresh for 20 minutes past the hour\n      // If the end is larger than the current time.\n      const nextFetch = new Date();\n\n      if (nextFetch.getMinutes() >= 20) {\n        nextFetch.setHours(nextFetch.getHours() + 1);\n      }\n\n      nextFetch.setMinutes(20, 0, 0);\n      collection._refreshTimeout = window.setTimeout(() => collection.refresh(), nextFetch.getTime() - Date.now());\n    }\n\n    return getEnergyData(hass, collection.prefs, collection.start, collection.end);\n  });\n  const origSubscribe = collection.subscribe;\n\n  collection.subscribe = subscriber => {\n    const unsub = origSubscribe(subscriber);\n    collection._active++;\n    return () => {\n      collection._active--;\n\n      if (collection._active < 1) {\n        clearTimeout(collection._refreshTimeout);\n        collection._refreshTimeout = undefined;\n      }\n\n      unsub();\n    };\n  };\n\n  collection._active = 0;\n  collection.prefs = options.prefs;\n  const now = new Date(); // Set start to start of today if we have data for today, otherwise yesterday\n\n  collection.start = now.getHours() > 0 ? (0,date_fns__WEBPACK_IMPORTED_MODULE_8__[\"default\"])() : (0,date_fns__WEBPACK_IMPORTED_MODULE_9__[\"default\"])();\n  collection.end = now.getHours() > 0 ? (0,date_fns__WEBPACK_IMPORTED_MODULE_10__[\"default\"])() : (0,date_fns__WEBPACK_IMPORTED_MODULE_11__[\"default\"])();\n\n  const scheduleUpdatePeriod = () => {\n    collection._updatePeriodTimeout = window.setTimeout(() => {\n      collection.start = (0,date_fns__WEBPACK_IMPORTED_MODULE_8__[\"default\"])();\n      collection.end = (0,date_fns__WEBPACK_IMPORTED_MODULE_10__[\"default\"])();\n      scheduleUpdatePeriod();\n    }, (0,date_fns__WEBPACK_IMPORTED_MODULE_6__[\"default\"])((0,date_fns__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(), 1).getTime() - Date.now() // Switch to next day an hour after the day changed\n    );\n  };\n\n  scheduleUpdatePeriod();\n\n  collection.clearPrefs = () => {\n    collection.prefs = undefined;\n  };\n\n  collection.setPeriod = (newStart, newEnd) => {\n    var _collection$end;\n\n    collection.start = newStart;\n    collection.end = newEnd;\n\n    if (collection.start.getTime() === (0,date_fns__WEBPACK_IMPORTED_MODULE_8__[\"default\"])().getTime() && ((_collection$end = collection.end) === null || _collection$end === void 0 ? void 0 : _collection$end.getTime()) === (0,date_fns__WEBPACK_IMPORTED_MODULE_10__[\"default\"])().getTime() && !collection._updatePeriodTimeout) {\n      scheduleUpdatePeriod();\n    } else if (collection._updatePeriodTimeout) {\n      clearTimeout(collection._updatePeriodTimeout);\n      collection._updatePeriodTimeout = undefined;\n    }\n  };\n\n  return collection;\n};\nconst getEnergySolarForecasts = hass => hass.callWS({\n  type: \"energy/solar_forecast\"\n});\nconst ENERGY_GAS_VOLUME_UNITS = [\"m³\", \"ft³\"];\nconst ENERGY_GAS_ENERGY_UNITS = [\"kWh\"];\nconst ENERGY_GAS_UNITS = [...ENERGY_GAS_VOLUME_UNITS, ...ENERGY_GAS_ENERGY_UNITS];\nconst getEnergyGasUnitCategory = (hass, prefs) => {\n  for (const source of prefs.energy_sources) {\n    if (source.type !== \"gas\") {\n      continue;\n    }\n\n    const entity = hass.states[source.stat_energy_from];\n\n    if (entity) {\n      return ENERGY_GAS_VOLUME_UNITS.includes(entity.attributes.unit_of_measurement) ? \"volume\" : \"energy\";\n    }\n  }\n\n  return undefined;\n};\nconst getEnergyGasUnit = (hass, prefs) => {\n  for (const source of prefs.energy_sources) {\n    if (source.type !== \"gas\") {\n      continue;\n    }\n\n    const entity = hass.states[source.stat_energy_from];\n\n    if (entity !== null && entity !== void 0 && entity.attributes.unit_of_measurement) {\n      // Wh is normalized to kWh by stats generation\n      return entity.attributes.unit_of_measurement === \"Wh\" ? \"kWh\" : entity.attributes.unit_of_measurement;\n    }\n\n    if (source.unit_of_measurement) {\n      return source.unit_of_measurement;\n    }\n  }\n\n  return undefined;\n};\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZGF0YS9lbmVyZ3kudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBUUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBT0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBUUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUpBO0FBT0E7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBRUE7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBK0dBO0FBRUE7QUFEQTtBQUlBO0FBRUE7QUFEQTtBQUlBO0FBRUE7QUFEQTtBQUlBO0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFNQTtBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQU5BO0FBZ0JBOztBQWNBO0FBTUE7QUFDQTtBQUFBO0FBS0E7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFHQTs7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBSUE7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFJQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFHQTtBQUVBO0FBUUE7O0FBRUE7QUFDQTtBQVFBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQU9BO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFSQTtBQVdBO0FBQ0E7O0FBYUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFJQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUVBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFFQTtBQUlBOztBQUVBO0FBTUE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFMQTtBQVFBOztBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFDQTtBQUFBOztBQUNBO0FBQ0E7O0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFEQTtBQUlBO0FBQ0E7QUFDQTtBQU9BO0FBSUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBQ0E7QUFDQTtBQUtBO0FBQ0E7O0FBQ0E7QUFDQTtBQUVBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBR0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2RhdGEvZW5lcmd5LnRzP2RjNDMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgYWRkSG91cnMsXG4gIGRpZmZlcmVuY2VJbkRheXMsXG4gIGVuZE9mVG9kYXksXG4gIGVuZE9mWWVzdGVyZGF5LFxuICBzdGFydE9mVG9kYXksXG4gIHN0YXJ0T2ZZZXN0ZXJkYXksXG59IGZyb20gXCJkYXRlLWZuc1wiO1xuaW1wb3J0IHsgQ29sbGVjdGlvbiwgZ2V0Q29sbGVjdGlvbiB9IGZyb20gXCJob21lLWFzc2lzdGFudC1qcy13ZWJzb2NrZXRcIjtcbmltcG9ydCB7IGdyb3VwQnkgfSBmcm9tIFwiLi4vY29tbW9uL3V0aWwvZ3JvdXAtYnlcIjtcbmltcG9ydCB7IHN1YnNjcmliZU9uZSB9IGZyb20gXCIuLi9jb21tb24vdXRpbC9zdWJzY3JpYmUtb25lXCI7XG5pbXBvcnQgeyBIb21lQXNzaXN0YW50IH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5pbXBvcnQgeyBDb25maWdFbnRyeSwgZ2V0Q29uZmlnRW50cmllcyB9IGZyb20gXCIuL2NvbmZpZ19lbnRyaWVzXCI7XG5pbXBvcnQgeyBzdWJzY3JpYmVFbnRpdHlSZWdpc3RyeSB9IGZyb20gXCIuL2VudGl0eV9yZWdpc3RyeVwiO1xuaW1wb3J0IHtcbiAgZmV0Y2hTdGF0aXN0aWNzLFxuICBTdGF0aXN0aWNzLFxuICBTdGF0aXN0aWNzTWV0YURhdGEsXG4gIGdldFN0YXRpc3RpY01ldGFkYXRhLFxufSBmcm9tIFwiLi9oaXN0b3J5XCI7XG5cbmNvbnN0IGVuZXJneUNvbGxlY3Rpb25LZXlzOiAoc3RyaW5nIHwgdW5kZWZpbmVkKVtdID0gW107XG5cbmV4cG9ydCBjb25zdCBlbXB0eUZsb3dGcm9tR3JpZFNvdXJjZUVuZXJneVByZWZlcmVuY2UgPVxuICAoKTogRmxvd0Zyb21HcmlkU291cmNlRW5lcmd5UHJlZmVyZW5jZSA9PiAoe1xuICAgIHN0YXRfZW5lcmd5X2Zyb206IFwiXCIsXG4gICAgc3RhdF9jb3N0OiBudWxsLFxuICAgIGVudGl0eV9lbmVyZ3lfZnJvbTogbnVsbCxcbiAgICBlbnRpdHlfZW5lcmd5X3ByaWNlOiBudWxsLFxuICAgIG51bWJlcl9lbmVyZ3lfcHJpY2U6IG51bGwsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgZW1wdHlGbG93VG9HcmlkU291cmNlRW5lcmd5UHJlZmVyZW5jZSA9XG4gICgpOiBGbG93VG9HcmlkU291cmNlRW5lcmd5UHJlZmVyZW5jZSA9PiAoe1xuICAgIHN0YXRfZW5lcmd5X3RvOiBcIlwiLFxuICAgIHN0YXRfY29tcGVuc2F0aW9uOiBudWxsLFxuICAgIGVudGl0eV9lbmVyZ3lfdG86IG51bGwsXG4gICAgZW50aXR5X2VuZXJneV9wcmljZTogbnVsbCxcbiAgICBudW1iZXJfZW5lcmd5X3ByaWNlOiBudWxsLFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IGVtcHR5R3JpZFNvdXJjZUVuZXJneVByZWZlcmVuY2UgPVxuICAoKTogR3JpZFNvdXJjZVR5cGVFbmVyZ3lQcmVmZXJlbmNlID0+ICh7XG4gICAgdHlwZTogXCJncmlkXCIsXG4gICAgZmxvd19mcm9tOiBbXSxcbiAgICBmbG93X3RvOiBbXSxcbiAgICBjb3N0X2FkanVzdG1lbnRfZGF5OiAwLFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IGVtcHR5U29sYXJFbmVyZ3lQcmVmZXJlbmNlID1cbiAgKCk6IFNvbGFyU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2UgPT4gKHtcbiAgICB0eXBlOiBcInNvbGFyXCIsXG4gICAgc3RhdF9lbmVyZ3lfZnJvbTogXCJcIixcbiAgICBjb25maWdfZW50cnlfc29sYXJfZm9yZWNhc3Q6IG51bGwsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgZW1wdHlCYXR0ZXJ5RW5lcmd5UHJlZmVyZW5jZSA9XG4gICgpOiBCYXR0ZXJ5U291cmNlVHlwZUVuZXJneVByZWZlcmVuY2UgPT4gKHtcbiAgICB0eXBlOiBcImJhdHRlcnlcIixcbiAgICBzdGF0X2VuZXJneV9mcm9tOiBcIlwiLFxuICAgIHN0YXRfZW5lcmd5X3RvOiBcIlwiLFxuICB9KTtcbmV4cG9ydCBjb25zdCBlbXB0eUdhc0VuZXJneVByZWZlcmVuY2UgPSAoKTogR2FzU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2UgPT4gKHtcbiAgdHlwZTogXCJnYXNcIixcbiAgc3RhdF9lbmVyZ3lfZnJvbTogXCJcIixcbiAgc3RhdF9jb3N0OiBudWxsLFxuICBlbnRpdHlfZW5lcmd5X2Zyb206IG51bGwsXG4gIGVudGl0eV9lbmVyZ3lfcHJpY2U6IG51bGwsXG4gIG51bWJlcl9lbmVyZ3lfcHJpY2U6IG51bGwsXG59KTtcblxuaW50ZXJmYWNlIEVuZXJneVNvbGFyRm9yZWNhc3Qge1xuICB3aF9ob3VyczogUmVjb3JkPHN0cmluZywgbnVtYmVyPjtcbn1cbmV4cG9ydCB0eXBlIEVuZXJneVNvbGFyRm9yZWNhc3RzID0ge1xuICBbY29uZmlnX2VudHJ5X2lkOiBzdHJpbmddOiBFbmVyZ3lTb2xhckZvcmVjYXN0O1xufTtcblxuZXhwb3J0IGludGVyZmFjZSBEZXZpY2VDb25zdW1wdGlvbkVuZXJneVByZWZlcmVuY2Uge1xuICAvLyBUaGlzIGlzIGFuIGV2ZXIgaW5jcmVhc2luZyB2YWx1ZVxuICBzdGF0X2NvbnN1bXB0aW9uOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmxvd0Zyb21HcmlkU291cmNlRW5lcmd5UHJlZmVyZW5jZSB7XG4gIC8vIGtXaCBtZXRlclxuICBzdGF0X2VuZXJneV9mcm9tOiBzdHJpbmc7XG5cbiAgLy8gJCBtZXRlclxuICBzdGF0X2Nvc3Q6IHN0cmluZyB8IG51bGw7XG5cbiAgLy8gQ2FuIGJlIHVzZWQgdG8gZ2VuZXJhdGUgY29zdHMgaWYgc3RhdF9jb3N0IG9taXR0ZWRcbiAgZW50aXR5X2VuZXJneV9mcm9tOiBzdHJpbmcgfCBudWxsO1xuICBlbnRpdHlfZW5lcmd5X3ByaWNlOiBzdHJpbmcgfCBudWxsO1xuICBudW1iZXJfZW5lcmd5X3ByaWNlOiBudW1iZXIgfCBudWxsO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZsb3dUb0dyaWRTb3VyY2VFbmVyZ3lQcmVmZXJlbmNlIHtcbiAgLy8ga1doIG1ldGVyXG4gIHN0YXRfZW5lcmd5X3RvOiBzdHJpbmc7XG5cbiAgLy8gJCBtZXRlclxuICBzdGF0X2NvbXBlbnNhdGlvbjogc3RyaW5nIHwgbnVsbDtcblxuICAvLyBDYW4gYmUgdXNlZCB0byBnZW5lcmF0ZSBjb3N0cyBpZiBzdGF0X2Nvc3Qgb21pdHRlZFxuICBlbnRpdHlfZW5lcmd5X3RvOiBzdHJpbmcgfCBudWxsO1xuICBlbnRpdHlfZW5lcmd5X3ByaWNlOiBzdHJpbmcgfCBudWxsO1xuICBudW1iZXJfZW5lcmd5X3ByaWNlOiBudW1iZXIgfCBudWxsO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEdyaWRTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZSB7XG4gIHR5cGU6IFwiZ3JpZFwiO1xuXG4gIGZsb3dfZnJvbTogRmxvd0Zyb21HcmlkU291cmNlRW5lcmd5UHJlZmVyZW5jZVtdO1xuICBmbG93X3RvOiBGbG93VG9HcmlkU291cmNlRW5lcmd5UHJlZmVyZW5jZVtdO1xuXG4gIGNvc3RfYWRqdXN0bWVudF9kYXk6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTb2xhclNvdXJjZVR5cGVFbmVyZ3lQcmVmZXJlbmNlIHtcbiAgdHlwZTogXCJzb2xhclwiO1xuXG4gIHN0YXRfZW5lcmd5X2Zyb206IHN0cmluZztcbiAgY29uZmlnX2VudHJ5X3NvbGFyX2ZvcmVjYXN0OiBzdHJpbmdbXSB8IG51bGw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmF0dGVyeVNvdXJjZVR5cGVFbmVyZ3lQcmVmZXJlbmNlIHtcbiAgdHlwZTogXCJiYXR0ZXJ5XCI7XG4gIHN0YXRfZW5lcmd5X2Zyb206IHN0cmluZztcbiAgc3RhdF9lbmVyZ3lfdG86IHN0cmluZztcbn1cbmV4cG9ydCBpbnRlcmZhY2UgR2FzU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2Uge1xuICB0eXBlOiBcImdhc1wiO1xuXG4gIC8vIGtXaCBtZXRlclxuICBzdGF0X2VuZXJneV9mcm9tOiBzdHJpbmc7XG5cbiAgLy8gJCBtZXRlclxuICBzdGF0X2Nvc3Q6IHN0cmluZyB8IG51bGw7XG5cbiAgLy8gQ2FuIGJlIHVzZWQgdG8gZ2VuZXJhdGUgY29zdHMgaWYgc3RhdF9jb3N0IG9taXR0ZWRcbiAgZW50aXR5X2VuZXJneV9mcm9tOiBzdHJpbmcgfCBudWxsO1xuICBlbnRpdHlfZW5lcmd5X3ByaWNlOiBzdHJpbmcgfCBudWxsO1xuICBudW1iZXJfZW5lcmd5X3ByaWNlOiBudW1iZXIgfCBudWxsO1xuICB1bml0X29mX21lYXN1cmVtZW50Pzogc3RyaW5nIHwgbnVsbDtcbn1cblxudHlwZSBFbmVyZ3lTb3VyY2UgPVxuICB8IFNvbGFyU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VcbiAgfCBHcmlkU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VcbiAgfCBCYXR0ZXJ5U291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VcbiAgfCBHYXNTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZTtcblxuZXhwb3J0IGludGVyZmFjZSBFbmVyZ3lQcmVmZXJlbmNlcyB7XG4gIGVuZXJneV9zb3VyY2VzOiBFbmVyZ3lTb3VyY2VbXTtcbiAgZGV2aWNlX2NvbnN1bXB0aW9uOiBEZXZpY2VDb25zdW1wdGlvbkVuZXJneVByZWZlcmVuY2VbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbmVyZ3lJbmZvIHtcbiAgY29zdF9zZW5zb3JzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICBzb2xhcl9mb3JlY2FzdF9kb21haW5zOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBFbmVyZ3lWYWxpZGF0aW9uSXNzdWUge1xuICB0eXBlOiBzdHJpbmc7XG4gIGlkZW50aWZpZXI6IHN0cmluZztcbiAgdmFsdWU/OiB1bmtub3duO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVuZXJneVByZWZlcmVuY2VzVmFsaWRhdGlvbiB7XG4gIGVuZXJneV9zb3VyY2VzOiBFbmVyZ3lWYWxpZGF0aW9uSXNzdWVbXVtdO1xuICBkZXZpY2VfY29uc3VtcHRpb246IEVuZXJneVZhbGlkYXRpb25Jc3N1ZVtdW107XG59XG5cbmV4cG9ydCBjb25zdCBnZXRFbmVyZ3lJbmZvID0gKGhhc3M6IEhvbWVBc3Npc3RhbnQpID0+XG4gIGhhc3MuY2FsbFdTPEVuZXJneUluZm8+KHtcbiAgICB0eXBlOiBcImVuZXJneS9pbmZvXCIsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgZ2V0RW5lcmd5UHJlZmVyZW5jZVZhbGlkYXRpb24gPSAoaGFzczogSG9tZUFzc2lzdGFudCkgPT5cbiAgaGFzcy5jYWxsV1M8RW5lcmd5UHJlZmVyZW5jZXNWYWxpZGF0aW9uPih7XG4gICAgdHlwZTogXCJlbmVyZ3kvdmFsaWRhdGVcIixcbiAgfSk7XG5cbmV4cG9ydCBjb25zdCBnZXRFbmVyZ3lQcmVmZXJlbmNlcyA9IChoYXNzOiBIb21lQXNzaXN0YW50KSA9PlxuICBoYXNzLmNhbGxXUzxFbmVyZ3lQcmVmZXJlbmNlcz4oe1xuICAgIHR5cGU6IFwiZW5lcmd5L2dldF9wcmVmc1wiLFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IHNhdmVFbmVyZ3lQcmVmZXJlbmNlcyA9IGFzeW5jIChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgcHJlZnM6IFBhcnRpYWw8RW5lcmd5UHJlZmVyZW5jZXM+XG4pID0+IHtcbiAgY29uc3QgbmV3UHJlZnMgPSBoYXNzLmNhbGxXUzxFbmVyZ3lQcmVmZXJlbmNlcz4oe1xuICAgIHR5cGU6IFwiZW5lcmd5L3NhdmVfcHJlZnNcIixcbiAgICAuLi5wcmVmcyxcbiAgfSk7XG4gIGNsZWFyRW5lcmd5Q29sbGVjdGlvblByZWZlcmVuY2VzKGhhc3MpO1xuICByZXR1cm4gbmV3UHJlZnM7XG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIEZvc3NpbEVuZXJneUNvbnN1bXB0aW9uIHtcbiAgW2RhdGU6IHN0cmluZ106IG51bWJlcjtcbn1cblxuZXhwb3J0IGNvbnN0IGdldEZvc3NpbEVuZXJneUNvbnN1bXB0aW9uID0gYXN5bmMgKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBzdGFydFRpbWU6IERhdGUsXG4gIGVuZXJneV9zdGF0aXN0aWNfaWRzOiBzdHJpbmdbXSxcbiAgY28yX3N0YXRpc3RpY19pZDogc3RyaW5nLFxuICBlbmRUaW1lPzogRGF0ZSxcbiAgcGVyaW9kOiBcIjVtaW51dGVcIiB8IFwiaG91clwiIHwgXCJkYXlcIiB8IFwibW9udGhcIiA9IFwiaG91clwiXG4pID0+XG4gIGhhc3MuY2FsbFdTPEZvc3NpbEVuZXJneUNvbnN1bXB0aW9uPih7XG4gICAgdHlwZTogXCJlbmVyZ3kvZm9zc2lsX2VuZXJneV9jb25zdW1wdGlvblwiLFxuICAgIHN0YXJ0X3RpbWU6IHN0YXJ0VGltZS50b0lTT1N0cmluZygpLFxuICAgIGVuZF90aW1lOiBlbmRUaW1lPy50b0lTT1N0cmluZygpLFxuICAgIGVuZXJneV9zdGF0aXN0aWNfaWRzLFxuICAgIGNvMl9zdGF0aXN0aWNfaWQsXG4gICAgcGVyaW9kLFxuICB9KTtcblxuaW50ZXJmYWNlIEVuZXJneVNvdXJjZUJ5VHlwZSB7XG4gIGdyaWQ/OiBHcmlkU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VbXTtcbiAgc29sYXI/OiBTb2xhclNvdXJjZVR5cGVFbmVyZ3lQcmVmZXJlbmNlW107XG4gIGJhdHRlcnk/OiBCYXR0ZXJ5U291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VbXTtcbiAgZ2FzPzogR2FzU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VbXTtcbn1cblxuZXhwb3J0IGNvbnN0IGVuZXJneVNvdXJjZXNCeVR5cGUgPSAocHJlZnM6IEVuZXJneVByZWZlcmVuY2VzKSA9PlxuICBncm91cEJ5KHByZWZzLmVuZXJneV9zb3VyY2VzLCAoaXRlbSkgPT4gaXRlbS50eXBlKSBhcyBFbmVyZ3lTb3VyY2VCeVR5cGU7XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW5lcmd5RGF0YSB7XG4gIHN0YXJ0OiBEYXRlO1xuICBlbmQ/OiBEYXRlO1xuICBwcmVmczogRW5lcmd5UHJlZmVyZW5jZXM7XG4gIGluZm86IEVuZXJneUluZm87XG4gIHN0YXRzOiBTdGF0aXN0aWNzO1xuICBjbzJTaWduYWxDb25maWdFbnRyeT86IENvbmZpZ0VudHJ5O1xuICBjbzJTaWduYWxFbnRpdHk/OiBzdHJpbmc7XG4gIGZvc3NpbEVuZXJneUNvbnN1bXB0aW9uPzogRm9zc2lsRW5lcmd5Q29uc3VtcHRpb247XG59XG5cbmNvbnN0IGdldEVuZXJneURhdGEgPSBhc3luYyAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIHByZWZzOiBFbmVyZ3lQcmVmZXJlbmNlcyxcbiAgc3RhcnQ6IERhdGUsXG4gIGVuZD86IERhdGVcbik6IFByb21pc2U8RW5lcmd5RGF0YT4gPT4ge1xuICBjb25zdCBbY29uZmlnRW50cmllcywgZW50aXR5UmVnaXN0cnlFbnRyaWVzLCBpbmZvXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICBnZXRDb25maWdFbnRyaWVzKGhhc3MsIHsgZG9tYWluOiBcImNvMnNpZ25hbFwiIH0pLFxuICAgIHN1YnNjcmliZU9uZShoYXNzLmNvbm5lY3Rpb24sIHN1YnNjcmliZUVudGl0eVJlZ2lzdHJ5KSxcbiAgICBnZXRFbmVyZ3lJbmZvKGhhc3MpLFxuICBdKTtcblxuICBjb25zdCBjbzJTaWduYWxDb25maWdFbnRyeSA9IGNvbmZpZ0VudHJpZXMubGVuZ3RoXG4gICAgPyBjb25maWdFbnRyaWVzWzBdXG4gICAgOiB1bmRlZmluZWQ7XG5cbiAgbGV0IGNvMlNpZ25hbEVudGl0eTogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gIGlmIChjbzJTaWduYWxDb25maWdFbnRyeSkge1xuICAgIGZvciAoY29uc3QgZW50cnkgb2YgZW50aXR5UmVnaXN0cnlFbnRyaWVzKSB7XG4gICAgICBpZiAoZW50cnkuY29uZmlnX2VudHJ5X2lkICE9PSBjbzJTaWduYWxDb25maWdFbnRyeS5lbnRyeV9pZCkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gVGhlIGludGVncmF0aW9uIG9mZmVycyAyIGVudGl0aWVzLiBXZSB3YW50IHRoZSAlIG9uZS5cbiAgICAgIGNvbnN0IGNvMlN0YXRlID0gaGFzcy5zdGF0ZXNbZW50cnkuZW50aXR5X2lkXTtcbiAgICAgIGlmICghY28yU3RhdGUgfHwgY28yU3RhdGUuYXR0cmlidXRlcy51bml0X29mX21lYXN1cmVtZW50ICE9PSBcIiVcIikge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgY28yU2lnbmFsRW50aXR5ID0gY28yU3RhdGUuZW50aXR5X2lkO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgY29uc3VtcHRpb25TdGF0SURzOiBzdHJpbmdbXSA9IFtdO1xuICBjb25zdCBzdGF0SURzOiBzdHJpbmdbXSA9IFtdO1xuICBjb25zdCBnYXNTb3VyY2VzOiBHYXNTb3VyY2VUeXBlRW5lcmd5UHJlZmVyZW5jZVtdID1cbiAgICBwcmVmcy5lbmVyZ3lfc291cmNlcy5maWx0ZXIoXG4gICAgICAoc291cmNlKSA9PiBzb3VyY2UudHlwZSA9PT0gXCJnYXNcIlxuICAgICkgYXMgR2FzU291cmNlVHlwZUVuZXJneVByZWZlcmVuY2VbXTtcbiAgY29uc3QgZ2FzU3RhdGlzdGljSWRzV2l0aE1ldGE6IFN0YXRpc3RpY3NNZXRhRGF0YVtdID1cbiAgICBhd2FpdCBnZXRTdGF0aXN0aWNNZXRhZGF0YShcbiAgICAgIGhhc3MsXG4gICAgICBnYXNTb3VyY2VzLm1hcCgoc291cmNlKSA9PiBzb3VyY2Uuc3RhdF9lbmVyZ3lfZnJvbSlcbiAgICApO1xuXG4gIGZvciAoY29uc3Qgc291cmNlIG9mIHByZWZzLmVuZXJneV9zb3VyY2VzKSB7XG4gICAgaWYgKHNvdXJjZS50eXBlID09PSBcInNvbGFyXCIpIHtcbiAgICAgIHN0YXRJRHMucHVzaChzb3VyY2Uuc3RhdF9lbmVyZ3lfZnJvbSk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoc291cmNlLnR5cGUgPT09IFwiZ2FzXCIpIHtcbiAgICAgIHN0YXRJRHMucHVzaChzb3VyY2Uuc3RhdF9lbmVyZ3lfZnJvbSk7XG4gICAgICBjb25zdCBlbnRpdHkgPSBoYXNzLnN0YXRlc1tzb3VyY2Uuc3RhdF9lbmVyZ3lfZnJvbV07XG4gICAgICBpZiAoIWVudGl0eSkge1xuICAgICAgICBmb3IgKGNvbnN0IHN0YXRpc3RpY0lkV2l0aE1ldGEgb2YgZ2FzU3RhdGlzdGljSWRzV2l0aE1ldGEpIHtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICBzdGF0aXN0aWNJZFdpdGhNZXRhPy5zdGF0aXN0aWNfaWQgPT09IHNvdXJjZS5zdGF0X2VuZXJneV9mcm9tICYmXG4gICAgICAgICAgICBzdGF0aXN0aWNJZFdpdGhNZXRhPy51bml0X29mX21lYXN1cmVtZW50XG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBzb3VyY2UudW5pdF9vZl9tZWFzdXJlbWVudCA9XG4gICAgICAgICAgICAgIHN0YXRpc3RpY0lkV2l0aE1ldGE/LnVuaXRfb2ZfbWVhc3VyZW1lbnQgPT09IFwiV2hcIlxuICAgICAgICAgICAgICAgID8gXCJrV2hcIlxuICAgICAgICAgICAgICAgIDogc3RhdGlzdGljSWRXaXRoTWV0YT8udW5pdF9vZl9tZWFzdXJlbWVudDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChzb3VyY2Uuc3RhdF9jb3N0KSB7XG4gICAgICAgIHN0YXRJRHMucHVzaChzb3VyY2Uuc3RhdF9jb3N0KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNvc3RTdGF0SWQgPSBpbmZvLmNvc3Rfc2Vuc29yc1tzb3VyY2Uuc3RhdF9lbmVyZ3lfZnJvbV07XG4gICAgICBpZiAoY29zdFN0YXRJZCkge1xuICAgICAgICBzdGF0SURzLnB1c2goY29zdFN0YXRJZCk7XG4gICAgICB9XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBpZiAoc291cmNlLnR5cGUgPT09IFwiYmF0dGVyeVwiKSB7XG4gICAgICBzdGF0SURzLnB1c2goc291cmNlLnN0YXRfZW5lcmd5X2Zyb20pO1xuICAgICAgc3RhdElEcy5wdXNoKHNvdXJjZS5zdGF0X2VuZXJneV90byk7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICAvLyBncmlkIHNvdXJjZVxuICAgIGZvciAoY29uc3QgZmxvd0Zyb20gb2Ygc291cmNlLmZsb3dfZnJvbSkge1xuICAgICAgY29uc3VtcHRpb25TdGF0SURzLnB1c2goZmxvd0Zyb20uc3RhdF9lbmVyZ3lfZnJvbSk7XG4gICAgICBzdGF0SURzLnB1c2goZmxvd0Zyb20uc3RhdF9lbmVyZ3lfZnJvbSk7XG4gICAgICBpZiAoZmxvd0Zyb20uc3RhdF9jb3N0KSB7XG4gICAgICAgIHN0YXRJRHMucHVzaChmbG93RnJvbS5zdGF0X2Nvc3QpO1xuICAgICAgfVxuICAgICAgY29uc3QgY29zdFN0YXRJZCA9IGluZm8uY29zdF9zZW5zb3JzW2Zsb3dGcm9tLnN0YXRfZW5lcmd5X2Zyb21dO1xuICAgICAgaWYgKGNvc3RTdGF0SWQpIHtcbiAgICAgICAgc3RhdElEcy5wdXNoKGNvc3RTdGF0SWQpO1xuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IGZsb3dUbyBvZiBzb3VyY2UuZmxvd190bykge1xuICAgICAgc3RhdElEcy5wdXNoKGZsb3dUby5zdGF0X2VuZXJneV90byk7XG4gICAgICBpZiAoZmxvd1RvLnN0YXRfY29tcGVuc2F0aW9uKSB7XG4gICAgICAgIHN0YXRJRHMucHVzaChmbG93VG8uc3RhdF9jb21wZW5zYXRpb24pO1xuICAgICAgfVxuICAgICAgY29uc3QgY29zdFN0YXRJZCA9IGluZm8uY29zdF9zZW5zb3JzW2Zsb3dUby5zdGF0X2VuZXJneV90b107XG4gICAgICBpZiAoY29zdFN0YXRJZCkge1xuICAgICAgICBzdGF0SURzLnB1c2goY29zdFN0YXRJZCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgY29uc3QgZGF5RGlmZmVyZW5jZSA9IGRpZmZlcmVuY2VJbkRheXMoZW5kIHx8IG5ldyBEYXRlKCksIHN0YXJ0KTtcblxuICAvLyBTdWJ0cmFjdCAxIGhvdXIgZnJvbSBzdGFydCB0byBnZXQgc3RhcnRpbmcgcG9pbnQgZGF0YVxuICBjb25zdCBzdGFydE1pbkhvdXIgPSBhZGRIb3VycyhzdGFydCwgLTEpO1xuXG4gIGNvbnN0IHN0YXRzID0gYXdhaXQgZmV0Y2hTdGF0aXN0aWNzKFxuICAgIGhhc3MhLFxuICAgIHN0YXJ0TWluSG91cixcbiAgICBlbmQsXG4gICAgc3RhdElEcyxcbiAgICBkYXlEaWZmZXJlbmNlID4gMzUgPyBcIm1vbnRoXCIgOiBkYXlEaWZmZXJlbmNlID4gMiA/IFwiZGF5XCIgOiBcImhvdXJcIlxuICApO1xuXG4gIGxldCBmb3NzaWxFbmVyZ3lDb25zdW1wdGlvbjogRm9zc2lsRW5lcmd5Q29uc3VtcHRpb24gfCB1bmRlZmluZWQ7XG5cbiAgaWYgKGNvMlNpZ25hbEVudGl0eSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZm9zc2lsRW5lcmd5Q29uc3VtcHRpb24gPSBhd2FpdCBnZXRGb3NzaWxFbmVyZ3lDb25zdW1wdGlvbihcbiAgICAgIGhhc3MhLFxuICAgICAgc3RhcnQsXG4gICAgICBjb25zdW1wdGlvblN0YXRJRHMsXG4gICAgICBjbzJTaWduYWxFbnRpdHksXG4gICAgICBlbmQsXG4gICAgICBkYXlEaWZmZXJlbmNlID4gMzUgPyBcIm1vbnRoXCIgOiBkYXlEaWZmZXJlbmNlID4gMiA/IFwiZGF5XCIgOiBcImhvdXJcIlxuICAgICk7XG4gIH1cblxuICBPYmplY3QudmFsdWVzKHN0YXRzKS5mb3JFYWNoKChzdGF0KSA9PiB7XG4gICAgLy8gaWYgdGhlIHN0YXJ0IG9mIHRoZSBmaXJzdCB2YWx1ZSBpcyBhZnRlciB0aGUgcmVxdWVzdGVkIHBlcmlvZCwgd2UgaGF2ZSB0aGUgZmlyc3QgZGF0YSBwb2ludCwgYW5kIHNob3VsZCBhZGQgYSB6ZXJvIHBvaW50XG4gICAgaWYgKHN0YXQubGVuZ3RoICYmIG5ldyBEYXRlKHN0YXRbMF0uc3RhcnQpID4gc3RhcnRNaW5Ib3VyKSB7XG4gICAgICBzdGF0LnVuc2hpZnQoe1xuICAgICAgICAuLi5zdGF0WzBdLFxuICAgICAgICBzdGFydDogc3RhcnRNaW5Ib3VyLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIGVuZDogc3RhcnRNaW5Ib3VyLnRvSVNPU3RyaW5nKCksXG4gICAgICAgIHN1bTogMCxcbiAgICAgICAgc3RhdGU6IDAsXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIGNvbnN0IGRhdGEgPSB7XG4gICAgc3RhcnQsXG4gICAgZW5kLFxuICAgIGluZm8sXG4gICAgcHJlZnMsXG4gICAgc3RhdHMsXG4gICAgY28yU2lnbmFsQ29uZmlnRW50cnksXG4gICAgY28yU2lnbmFsRW50aXR5LFxuICAgIGZvc3NpbEVuZXJneUNvbnN1bXB0aW9uLFxuICB9O1xuXG4gIHJldHVybiBkYXRhO1xufTtcblxuZXhwb3J0IGludGVyZmFjZSBFbmVyZ3lDb2xsZWN0aW9uIGV4dGVuZHMgQ29sbGVjdGlvbjxFbmVyZ3lEYXRhPiB7XG4gIHN0YXJ0OiBEYXRlO1xuICBlbmQ/OiBEYXRlO1xuICBwcmVmcz86IEVuZXJneVByZWZlcmVuY2VzO1xuICBjbGVhclByZWZzKCk6IHZvaWQ7XG4gIHNldFBlcmlvZChuZXdTdGFydDogRGF0ZSwgbmV3RW5kPzogRGF0ZSk6IHZvaWQ7XG4gIF9yZWZyZXNoVGltZW91dD86IG51bWJlcjtcbiAgX3VwZGF0ZVBlcmlvZFRpbWVvdXQ/OiBudW1iZXI7XG4gIF9hY3RpdmU6IG51bWJlcjtcbn1cblxuY29uc3QgY2xlYXJFbmVyZ3lDb2xsZWN0aW9uUHJlZmVyZW5jZXMgPSAoaGFzczogSG9tZUFzc2lzdGFudCkgPT4ge1xuICBlbmVyZ3lDb2xsZWN0aW9uS2V5cy5mb3JFYWNoKChrZXkpID0+IHtcbiAgICBjb25zdCBlbmVyZ3lDb2xsZWN0aW9uID0gZ2V0RW5lcmd5RGF0YUNvbGxlY3Rpb24oaGFzcywgeyBrZXkgfSk7XG4gICAgZW5lcmd5Q29sbGVjdGlvbi5jbGVhclByZWZzKCk7XG4gICAgaWYgKGVuZXJneUNvbGxlY3Rpb24uX2FjdGl2ZSkge1xuICAgICAgZW5lcmd5Q29sbGVjdGlvbi5yZWZyZXNoKCk7XG4gICAgfVxuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRFbmVyZ3lEYXRhQ29sbGVjdGlvbiA9IChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgb3B0aW9uczogeyBwcmVmcz86IEVuZXJneVByZWZlcmVuY2VzOyBrZXk/OiBzdHJpbmcgfSA9IHt9XG4pOiBFbmVyZ3lDb2xsZWN0aW9uID0+IHtcbiAgbGV0IGtleSA9IFwiX2VuZXJneVwiO1xuICBpZiAob3B0aW9ucy5rZXkpIHtcbiAgICBpZiAoIW9wdGlvbnMua2V5LnN0YXJ0c1dpdGgoXCJlbmVyZ3lfXCIpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJLZXkgbmVlZCB0byBzdGFydCB3aXRoIGVuZXJneV9cIik7XG4gICAgfVxuICAgIGtleSA9IGBfJHtvcHRpb25zLmtleX1gO1xuICB9XG5cbiAgaWYgKChoYXNzLmNvbm5lY3Rpb24gYXMgYW55KVtrZXldKSB7XG4gICAgcmV0dXJuIChoYXNzLmNvbm5lY3Rpb24gYXMgYW55KVtrZXldO1xuICB9XG5cbiAgZW5lcmd5Q29sbGVjdGlvbktleXMucHVzaChvcHRpb25zLmtleSk7XG5cbiAgY29uc3QgY29sbGVjdGlvbiA9IGdldENvbGxlY3Rpb248RW5lcmd5RGF0YT4oXG4gICAgaGFzcy5jb25uZWN0aW9uLFxuICAgIGtleSxcbiAgICBhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoIWNvbGxlY3Rpb24ucHJlZnMpIHtcbiAgICAgICAgLy8gVGhpcyB3aWxsIHJhaXNlIGlmIG5vdCBmb3VuZC5cbiAgICAgICAgLy8gRGV0ZWN0IGJ5IGNoZWNraW5nIGBlLmNvZGUgPT09IFwibm90X2ZvdW5kXCJcbiAgICAgICAgY29sbGVjdGlvbi5wcmVmcyA9IGF3YWl0IGdldEVuZXJneVByZWZlcmVuY2VzKGhhc3MpO1xuICAgICAgfVxuXG4gICAgICBpZiAoY29sbGVjdGlvbi5fcmVmcmVzaFRpbWVvdXQpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KGNvbGxlY3Rpb24uX3JlZnJlc2hUaW1lb3V0KTtcbiAgICAgIH1cblxuICAgICAgaWYgKFxuICAgICAgICBjb2xsZWN0aW9uLl9hY3RpdmUgJiZcbiAgICAgICAgKCFjb2xsZWN0aW9uLmVuZCB8fCBjb2xsZWN0aW9uLmVuZCA+IG5ldyBEYXRlKCkpXG4gICAgICApIHtcbiAgICAgICAgLy8gVGhlIHN0YXRzIGFyZSBjcmVhdGVkIGV2ZXJ5IGhvdXJcbiAgICAgICAgLy8gU2NoZWR1bGUgYSByZWZyZXNoIGZvciAyMCBtaW51dGVzIHBhc3QgdGhlIGhvdXJcbiAgICAgICAgLy8gSWYgdGhlIGVuZCBpcyBsYXJnZXIgdGhhbiB0aGUgY3VycmVudCB0aW1lLlxuICAgICAgICBjb25zdCBuZXh0RmV0Y2ggPSBuZXcgRGF0ZSgpO1xuICAgICAgICBpZiAobmV4dEZldGNoLmdldE1pbnV0ZXMoKSA+PSAyMCkge1xuICAgICAgICAgIG5leHRGZXRjaC5zZXRIb3VycyhuZXh0RmV0Y2guZ2V0SG91cnMoKSArIDEpO1xuICAgICAgICB9XG4gICAgICAgIG5leHRGZXRjaC5zZXRNaW51dGVzKDIwLCAwLCAwKTtcblxuICAgICAgICBjb2xsZWN0aW9uLl9yZWZyZXNoVGltZW91dCA9IHdpbmRvdy5zZXRUaW1lb3V0KFxuICAgICAgICAgICgpID0+IGNvbGxlY3Rpb24ucmVmcmVzaCgpLFxuICAgICAgICAgIG5leHRGZXRjaC5nZXRUaW1lKCkgLSBEYXRlLm5vdygpXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBnZXRFbmVyZ3lEYXRhKFxuICAgICAgICBoYXNzLFxuICAgICAgICBjb2xsZWN0aW9uLnByZWZzLFxuICAgICAgICBjb2xsZWN0aW9uLnN0YXJ0LFxuICAgICAgICBjb2xsZWN0aW9uLmVuZFxuICAgICAgKTtcbiAgICB9XG4gICkgYXMgRW5lcmd5Q29sbGVjdGlvbjtcblxuICBjb25zdCBvcmlnU3Vic2NyaWJlID0gY29sbGVjdGlvbi5zdWJzY3JpYmU7XG5cbiAgY29sbGVjdGlvbi5zdWJzY3JpYmUgPSAoc3Vic2NyaWJlcjogKGRhdGE6IEVuZXJneURhdGEpID0+IHZvaWQpID0+IHtcbiAgICBjb25zdCB1bnN1YiA9IG9yaWdTdWJzY3JpYmUoc3Vic2NyaWJlcik7XG4gICAgY29sbGVjdGlvbi5fYWN0aXZlKys7XG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGNvbGxlY3Rpb24uX2FjdGl2ZS0tO1xuICAgICAgaWYgKGNvbGxlY3Rpb24uX2FjdGl2ZSA8IDEpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KGNvbGxlY3Rpb24uX3JlZnJlc2hUaW1lb3V0KTtcbiAgICAgICAgY29sbGVjdGlvbi5fcmVmcmVzaFRpbWVvdXQgPSB1bmRlZmluZWQ7XG4gICAgICB9XG4gICAgICB1bnN1YigpO1xuICAgIH07XG4gIH07XG5cbiAgY29sbGVjdGlvbi5fYWN0aXZlID0gMDtcbiAgY29sbGVjdGlvbi5wcmVmcyA9IG9wdGlvbnMucHJlZnM7XG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gIC8vIFNldCBzdGFydCB0byBzdGFydCBvZiB0b2RheSBpZiB3ZSBoYXZlIGRhdGEgZm9yIHRvZGF5LCBvdGhlcndpc2UgeWVzdGVyZGF5XG4gIGNvbGxlY3Rpb24uc3RhcnQgPSBub3cuZ2V0SG91cnMoKSA+IDAgPyBzdGFydE9mVG9kYXkoKSA6IHN0YXJ0T2ZZZXN0ZXJkYXkoKTtcbiAgY29sbGVjdGlvbi5lbmQgPSBub3cuZ2V0SG91cnMoKSA+IDAgPyBlbmRPZlRvZGF5KCkgOiBlbmRPZlllc3RlcmRheSgpO1xuXG4gIGNvbnN0IHNjaGVkdWxlVXBkYXRlUGVyaW9kID0gKCkgPT4ge1xuICAgIGNvbGxlY3Rpb24uX3VwZGF0ZVBlcmlvZFRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dChcbiAgICAgICgpID0+IHtcbiAgICAgICAgY29sbGVjdGlvbi5zdGFydCA9IHN0YXJ0T2ZUb2RheSgpO1xuICAgICAgICBjb2xsZWN0aW9uLmVuZCA9IGVuZE9mVG9kYXkoKTtcbiAgICAgICAgc2NoZWR1bGVVcGRhdGVQZXJpb2QoKTtcbiAgICAgIH0sXG4gICAgICBhZGRIb3VycyhlbmRPZlRvZGF5KCksIDEpLmdldFRpbWUoKSAtIERhdGUubm93KCkgLy8gU3dpdGNoIHRvIG5leHQgZGF5IGFuIGhvdXIgYWZ0ZXIgdGhlIGRheSBjaGFuZ2VkXG4gICAgKTtcbiAgfTtcbiAgc2NoZWR1bGVVcGRhdGVQZXJpb2QoKTtcblxuICBjb2xsZWN0aW9uLmNsZWFyUHJlZnMgPSAoKSA9PiB7XG4gICAgY29sbGVjdGlvbi5wcmVmcyA9IHVuZGVmaW5lZDtcbiAgfTtcbiAgY29sbGVjdGlvbi5zZXRQZXJpb2QgPSAobmV3U3RhcnQ6IERhdGUsIG5ld0VuZD86IERhdGUpID0+IHtcbiAgICBjb2xsZWN0aW9uLnN0YXJ0ID0gbmV3U3RhcnQ7XG4gICAgY29sbGVjdGlvbi5lbmQgPSBuZXdFbmQ7XG4gICAgaWYgKFxuICAgICAgY29sbGVjdGlvbi5zdGFydC5nZXRUaW1lKCkgPT09IHN0YXJ0T2ZUb2RheSgpLmdldFRpbWUoKSAmJlxuICAgICAgY29sbGVjdGlvbi5lbmQ/LmdldFRpbWUoKSA9PT0gZW5kT2ZUb2RheSgpLmdldFRpbWUoKSAmJlxuICAgICAgIWNvbGxlY3Rpb24uX3VwZGF0ZVBlcmlvZFRpbWVvdXRcbiAgICApIHtcbiAgICAgIHNjaGVkdWxlVXBkYXRlUGVyaW9kKCk7XG4gICAgfSBlbHNlIGlmIChjb2xsZWN0aW9uLl91cGRhdGVQZXJpb2RUaW1lb3V0KSB7XG4gICAgICBjbGVhclRpbWVvdXQoY29sbGVjdGlvbi5fdXBkYXRlUGVyaW9kVGltZW91dCk7XG4gICAgICBjb2xsZWN0aW9uLl91cGRhdGVQZXJpb2RUaW1lb3V0ID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgfTtcbiAgcmV0dXJuIGNvbGxlY3Rpb247XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0RW5lcmd5U29sYXJGb3JlY2FzdHMgPSAoaGFzczogSG9tZUFzc2lzdGFudCkgPT5cbiAgaGFzcy5jYWxsV1M8RW5lcmd5U29sYXJGb3JlY2FzdHM+KHtcbiAgICB0eXBlOiBcImVuZXJneS9zb2xhcl9mb3JlY2FzdFwiLFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IEVORVJHWV9HQVNfVk9MVU1FX1VOSVRTID0gW1wibcKzXCIsIFwiZnTCs1wiXTtcbmV4cG9ydCBjb25zdCBFTkVSR1lfR0FTX0VORVJHWV9VTklUUyA9IFtcImtXaFwiXTtcbmV4cG9ydCBjb25zdCBFTkVSR1lfR0FTX1VOSVRTID0gW1xuICAuLi5FTkVSR1lfR0FTX1ZPTFVNRV9VTklUUyxcbiAgLi4uRU5FUkdZX0dBU19FTkVSR1lfVU5JVFMsXG5dO1xuXG5leHBvcnQgdHlwZSBFbmVyZ3lHYXNVbml0ID0gXCJ2b2x1bWVcIiB8IFwiZW5lcmd5XCI7XG5cbmV4cG9ydCBjb25zdCBnZXRFbmVyZ3lHYXNVbml0Q2F0ZWdvcnkgPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIHByZWZzOiBFbmVyZ3lQcmVmZXJlbmNlc1xuKTogRW5lcmd5R2FzVW5pdCB8IHVuZGVmaW5lZCA9PiB7XG4gIGZvciAoY29uc3Qgc291cmNlIG9mIHByZWZzLmVuZXJneV9zb3VyY2VzKSB7XG4gICAgaWYgKHNvdXJjZS50eXBlICE9PSBcImdhc1wiKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICBjb25zdCBlbnRpdHkgPSBoYXNzLnN0YXRlc1tzb3VyY2Uuc3RhdF9lbmVyZ3lfZnJvbV07XG4gICAgaWYgKGVudGl0eSkge1xuICAgICAgcmV0dXJuIEVORVJHWV9HQVNfVk9MVU1FX1VOSVRTLmluY2x1ZGVzKFxuICAgICAgICBlbnRpdHkuYXR0cmlidXRlcy51bml0X29mX21lYXN1cmVtZW50IVxuICAgICAgKVxuICAgICAgICA/IFwidm9sdW1lXCJcbiAgICAgICAgOiBcImVuZXJneVwiO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEVuZXJneUdhc1VuaXQgPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIHByZWZzOiBFbmVyZ3lQcmVmZXJlbmNlc1xuKTogc3RyaW5nIHwgdW5kZWZpbmVkID0+IHtcbiAgZm9yIChjb25zdCBzb3VyY2Ugb2YgcHJlZnMuZW5lcmd5X3NvdXJjZXMpIHtcbiAgICBpZiAoc291cmNlLnR5cGUgIT09IFwiZ2FzXCIpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGNvbnN0IGVudGl0eSA9IGhhc3Muc3RhdGVzW3NvdXJjZS5zdGF0X2VuZXJneV9mcm9tXTtcbiAgICBpZiAoZW50aXR5Py5hdHRyaWJ1dGVzLnVuaXRfb2ZfbWVhc3VyZW1lbnQpIHtcbiAgICAgIC8vIFdoIGlzIG5vcm1hbGl6ZWQgdG8ga1doIGJ5IHN0YXRzIGdlbmVyYXRpb25cbiAgICAgIHJldHVybiBlbnRpdHkuYXR0cmlidXRlcy51bml0X29mX21lYXN1cmVtZW50ID09PSBcIldoXCJcbiAgICAgICAgPyBcImtXaFwiXG4gICAgICAgIDogZW50aXR5LmF0dHJpYnV0ZXMudW5pdF9vZl9tZWFzdXJlbWVudDtcbiAgICB9XG4gICAgaWYgKHNvdXJjZS51bml0X29mX21lYXN1cmVtZW50KSB7XG4gICAgICByZXR1cm4gc291cmNlLnVuaXRfb2ZfbWVhc3VyZW1lbnQ7XG4gICAgfVxuICB9XG4gIHJldHVybiB1bmRlZmluZWQ7XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./src/data/energy.ts\n");

/***/ }),

/***/ "./src/data/entity_registry.ts":
/*!*************************************!*\
  !*** ./src/data/entity_registry.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"findBatteryEntity\": () => (/* binding */ findBatteryEntity),\n/* harmony export */   \"findBatteryChargingEntity\": () => (/* binding */ findBatteryChargingEntity),\n/* harmony export */   \"computeEntityRegistryName\": () => (/* binding */ computeEntityRegistryName),\n/* harmony export */   \"getExtendedEntityRegistryEntry\": () => (/* binding */ getExtendedEntityRegistryEntry),\n/* harmony export */   \"updateEntityRegistryEntry\": () => (/* binding */ updateEntityRegistryEntry),\n/* harmony export */   \"removeEntityRegistryEntry\": () => (/* binding */ removeEntityRegistryEntry),\n/* harmony export */   \"fetchEntityRegistry\": () => (/* binding */ fetchEntityRegistry),\n/* harmony export */   \"subscribeEntityRegistry\": () => (/* binding */ subscribeEntityRegistry),\n/* harmony export */   \"sortEntityRegistryByName\": () => (/* binding */ sortEntityRegistryByName)\n/* harmony export */ });\n/* harmony import */ var home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! home-assistant-js-websocket */ \"./node_modules/home-assistant-js-websocket/dist/collection.js\");\n/* harmony import */ var _common_entity_compute_state_name__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/entity/compute_state_name */ \"./src/common/entity/compute_state_name.ts\");\n/* harmony import */ var _common_string_compare__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/string/compare */ \"./src/common/string/compare.ts\");\n/* harmony import */ var _common_util_debounce__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/util/debounce */ \"./src/common/util/debounce.ts\");\n\n\n\n\nconst findBatteryEntity = (hass, entities) => entities.find(entity => hass.states[entity.entity_id] && hass.states[entity.entity_id].attributes.device_class === \"battery\");\nconst findBatteryChargingEntity = (hass, entities) => entities.find(entity => hass.states[entity.entity_id] && hass.states[entity.entity_id].attributes.device_class === \"battery_charging\");\nconst computeEntityRegistryName = (hass, entry) => {\n  if (entry.name) {\n    return entry.name;\n  }\n\n  const state = hass.states[entry.entity_id];\n  return state ? (0,_common_entity_compute_state_name__WEBPACK_IMPORTED_MODULE_0__.computeStateName)(state) : entry.entity_id;\n};\nconst getExtendedEntityRegistryEntry = (hass, entityId) => hass.callWS({\n  type: \"config/entity_registry/get\",\n  entity_id: entityId\n});\nconst updateEntityRegistryEntry = (hass, entityId, updates) => hass.callWS({\n  type: \"config/entity_registry/update\",\n  entity_id: entityId,\n  ...updates\n});\nconst removeEntityRegistryEntry = (hass, entityId) => hass.callWS({\n  type: \"config/entity_registry/remove\",\n  entity_id: entityId\n});\nconst fetchEntityRegistry = conn => conn.sendMessagePromise({\n  type: \"config/entity_registry/list\"\n});\n\nconst subscribeEntityRegistryUpdates = (conn, store) => conn.subscribeEvents((0,_common_util_debounce__WEBPACK_IMPORTED_MODULE_2__.debounce)(() => fetchEntityRegistry(conn).then(entities => store.setState(entities, true)), 500, true), \"entity_registry_updated\");\n\nconst subscribeEntityRegistry = (conn, onChange) => (0,home_assistant_js_websocket__WEBPACK_IMPORTED_MODULE_3__.createCollection)(\"_entityRegistry\", fetchEntityRegistry, subscribeEntityRegistryUpdates, conn, onChange);\nconst sortEntityRegistryByName = entries => entries.sort((entry1, entry2) => (0,_common_string_compare__WEBPACK_IMPORTED_MODULE_1__.caseInsensitiveStringCompare)(entry1.name || \"\", entry2.name || \"\"));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZGF0YS9lbnRpdHlfcmVnaXN0cnkudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBRUE7QUFDQTtBQUNBO0FBNkNBO0FBVUE7QUFXQTtBQUlBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUtBO0FBQ0E7QUFGQTtBQUtBO0FBTUE7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUtBO0FBQ0E7QUFGQTtBQUtBO0FBRUE7QUFEQTs7QUFJQTs7QUFnQkE7QUFZQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2RhdGEvZW50aXR5X3JlZ2lzdHJ5LnRzPzNhNzkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29ubmVjdGlvbiwgY3JlYXRlQ29sbGVjdGlvbiB9IGZyb20gXCJob21lLWFzc2lzdGFudC1qcy13ZWJzb2NrZXRcIjtcbmltcG9ydCB7IFN0b3JlIH0gZnJvbSBcImhvbWUtYXNzaXN0YW50LWpzLXdlYnNvY2tldC9kaXN0L3N0b3JlXCI7XG5pbXBvcnQgeyBjb21wdXRlU3RhdGVOYW1lIH0gZnJvbSBcIi4uL2NvbW1vbi9lbnRpdHkvY29tcHV0ZV9zdGF0ZV9uYW1lXCI7XG5pbXBvcnQgeyBjYXNlSW5zZW5zaXRpdmVTdHJpbmdDb21wYXJlIH0gZnJvbSBcIi4uL2NvbW1vbi9zdHJpbmcvY29tcGFyZVwiO1xuaW1wb3J0IHsgZGVib3VuY2UgfSBmcm9tIFwiLi4vY29tbW9uL3V0aWwvZGVib3VuY2VcIjtcbmltcG9ydCB7IEhvbWVBc3Npc3RhbnQgfSBmcm9tIFwiLi4vdHlwZXNcIjtcblxuZXhwb3J0IGludGVyZmFjZSBFbnRpdHlSZWdpc3RyeUVudHJ5IHtcbiAgZW50aXR5X2lkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZyB8IG51bGw7XG4gIGljb246IHN0cmluZyB8IG51bGw7XG4gIHBsYXRmb3JtOiBzdHJpbmc7XG4gIGNvbmZpZ19lbnRyeV9pZDogc3RyaW5nIHwgbnVsbDtcbiAgZGV2aWNlX2lkOiBzdHJpbmcgfCBudWxsO1xuICBhcmVhX2lkOiBzdHJpbmcgfCBudWxsO1xuICBkaXNhYmxlZF9ieTogc3RyaW5nIHwgbnVsbDtcbiAgaGlkZGVuX2J5OiBzdHJpbmcgfCBudWxsO1xuICBlbnRpdHlfY2F0ZWdvcnk6IFwiY29uZmlnXCIgfCBcImRpYWdub3N0aWNcIiB8IG51bGw7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRXh0RW50aXR5UmVnaXN0cnlFbnRyeSBleHRlbmRzIEVudGl0eVJlZ2lzdHJ5RW50cnkge1xuICB1bmlxdWVfaWQ6IHN0cmluZztcbiAgY2FwYWJpbGl0aWVzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgb3JpZ2luYWxfbmFtZT86IHN0cmluZztcbiAgb3JpZ2luYWxfaWNvbj86IHN0cmluZztcbiAgZGV2aWNlX2NsYXNzPzogc3RyaW5nO1xuICBvcmlnaW5hbF9kZXZpY2VfY2xhc3M/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXBkYXRlRW50aXR5UmVnaXN0cnlFbnRyeVJlc3VsdCB7XG4gIGVudGl0eV9lbnRyeTogRXh0RW50aXR5UmVnaXN0cnlFbnRyeTtcbiAgcmVsb2FkX2RlbGF5PzogbnVtYmVyO1xuICByZXF1aXJlX3Jlc3RhcnQ/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVudGl0eVJlZ2lzdHJ5RW50cnlVcGRhdGVQYXJhbXMge1xuICBuYW1lPzogc3RyaW5nIHwgbnVsbDtcbiAgaWNvbj86IHN0cmluZyB8IG51bGw7XG4gIGRldmljZV9jbGFzcz86IHN0cmluZyB8IG51bGw7XG4gIGFyZWFfaWQ/OiBzdHJpbmcgfCBudWxsO1xuICBkaXNhYmxlZF9ieT86IHN0cmluZyB8IG51bGw7XG4gIGhpZGRlbl9ieTogc3RyaW5nIHwgbnVsbDtcbiAgbmV3X2VudGl0eV9pZD86IHN0cmluZztcbiAgb3B0aW9uc19kb21haW4/OiBzdHJpbmc7XG4gIG9wdGlvbnM/OiB7XG4gICAgdW5pdF9vZl9tZWFzdXJlbWVudD86IHN0cmluZyB8IG51bGw7XG4gIH07XG59XG5cbmV4cG9ydCBjb25zdCBmaW5kQmF0dGVyeUVudGl0eSA9IChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgZW50aXRpZXM6IEVudGl0eVJlZ2lzdHJ5RW50cnlbXVxuKTogRW50aXR5UmVnaXN0cnlFbnRyeSB8IHVuZGVmaW5lZCA9PlxuICBlbnRpdGllcy5maW5kKFxuICAgIChlbnRpdHkpID0+XG4gICAgICBoYXNzLnN0YXRlc1tlbnRpdHkuZW50aXR5X2lkXSAmJlxuICAgICAgaGFzcy5zdGF0ZXNbZW50aXR5LmVudGl0eV9pZF0uYXR0cmlidXRlcy5kZXZpY2VfY2xhc3MgPT09IFwiYmF0dGVyeVwiXG4gICk7XG5cbmV4cG9ydCBjb25zdCBmaW5kQmF0dGVyeUNoYXJnaW5nRW50aXR5ID0gKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBlbnRpdGllczogRW50aXR5UmVnaXN0cnlFbnRyeVtdXG4pOiBFbnRpdHlSZWdpc3RyeUVudHJ5IHwgdW5kZWZpbmVkID0+XG4gIGVudGl0aWVzLmZpbmQoXG4gICAgKGVudGl0eSkgPT5cbiAgICAgIGhhc3Muc3RhdGVzW2VudGl0eS5lbnRpdHlfaWRdICYmXG4gICAgICBoYXNzLnN0YXRlc1tlbnRpdHkuZW50aXR5X2lkXS5hdHRyaWJ1dGVzLmRldmljZV9jbGFzcyA9PT1cbiAgICAgICAgXCJiYXR0ZXJ5X2NoYXJnaW5nXCJcbiAgKTtcblxuZXhwb3J0IGNvbnN0IGNvbXB1dGVFbnRpdHlSZWdpc3RyeU5hbWUgPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIGVudHJ5OiBFbnRpdHlSZWdpc3RyeUVudHJ5XG4pOiBzdHJpbmcgfCBudWxsID0+IHtcbiAgaWYgKGVudHJ5Lm5hbWUpIHtcbiAgICByZXR1cm4gZW50cnkubmFtZTtcbiAgfVxuICBjb25zdCBzdGF0ZSA9IGhhc3Muc3RhdGVzW2VudHJ5LmVudGl0eV9pZF07XG4gIHJldHVybiBzdGF0ZSA/IGNvbXB1dGVTdGF0ZU5hbWUoc3RhdGUpIDogZW50cnkuZW50aXR5X2lkO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldEV4dGVuZGVkRW50aXR5UmVnaXN0cnlFbnRyeSA9IChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgZW50aXR5SWQ6IHN0cmluZ1xuKTogUHJvbWlzZTxFeHRFbnRpdHlSZWdpc3RyeUVudHJ5PiA9PlxuICBoYXNzLmNhbGxXUyh7XG4gICAgdHlwZTogXCJjb25maWcvZW50aXR5X3JlZ2lzdHJ5L2dldFwiLFxuICAgIGVudGl0eV9pZDogZW50aXR5SWQsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgdXBkYXRlRW50aXR5UmVnaXN0cnlFbnRyeSA9IChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgZW50aXR5SWQ6IHN0cmluZyxcbiAgdXBkYXRlczogUGFydGlhbDxFbnRpdHlSZWdpc3RyeUVudHJ5VXBkYXRlUGFyYW1zPlxuKTogUHJvbWlzZTxVcGRhdGVFbnRpdHlSZWdpc3RyeUVudHJ5UmVzdWx0PiA9PlxuICBoYXNzLmNhbGxXUyh7XG4gICAgdHlwZTogXCJjb25maWcvZW50aXR5X3JlZ2lzdHJ5L3VwZGF0ZVwiLFxuICAgIGVudGl0eV9pZDogZW50aXR5SWQsXG4gICAgLi4udXBkYXRlcyxcbiAgfSk7XG5cbmV4cG9ydCBjb25zdCByZW1vdmVFbnRpdHlSZWdpc3RyeUVudHJ5ID0gKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBlbnRpdHlJZDogc3RyaW5nXG4pOiBQcm9taXNlPHZvaWQ+ID0+XG4gIGhhc3MuY2FsbFdTKHtcbiAgICB0eXBlOiBcImNvbmZpZy9lbnRpdHlfcmVnaXN0cnkvcmVtb3ZlXCIsXG4gICAgZW50aXR5X2lkOiBlbnRpdHlJZCxcbiAgfSk7XG5cbmV4cG9ydCBjb25zdCBmZXRjaEVudGl0eVJlZ2lzdHJ5ID0gKGNvbm46IENvbm5lY3Rpb24pID0+XG4gIGNvbm4uc2VuZE1lc3NhZ2VQcm9taXNlPEVudGl0eVJlZ2lzdHJ5RW50cnlbXT4oe1xuICAgIHR5cGU6IFwiY29uZmlnL2VudGl0eV9yZWdpc3RyeS9saXN0XCIsXG4gIH0pO1xuXG5jb25zdCBzdWJzY3JpYmVFbnRpdHlSZWdpc3RyeVVwZGF0ZXMgPSAoXG4gIGNvbm46IENvbm5lY3Rpb24sXG4gIHN0b3JlOiBTdG9yZTxFbnRpdHlSZWdpc3RyeUVudHJ5W10+XG4pID0+XG4gIGNvbm4uc3Vic2NyaWJlRXZlbnRzKFxuICAgIGRlYm91bmNlKFxuICAgICAgKCkgPT5cbiAgICAgICAgZmV0Y2hFbnRpdHlSZWdpc3RyeShjb25uKS50aGVuKChlbnRpdGllcykgPT5cbiAgICAgICAgICBzdG9yZS5zZXRTdGF0ZShlbnRpdGllcywgdHJ1ZSlcbiAgICAgICAgKSxcbiAgICAgIDUwMCxcbiAgICAgIHRydWVcbiAgICApLFxuICAgIFwiZW50aXR5X3JlZ2lzdHJ5X3VwZGF0ZWRcIlxuICApO1xuXG5leHBvcnQgY29uc3Qgc3Vic2NyaWJlRW50aXR5UmVnaXN0cnkgPSAoXG4gIGNvbm46IENvbm5lY3Rpb24sXG4gIG9uQ2hhbmdlOiAoZW50aXRpZXM6IEVudGl0eVJlZ2lzdHJ5RW50cnlbXSkgPT4gdm9pZFxuKSA9PlxuICBjcmVhdGVDb2xsZWN0aW9uPEVudGl0eVJlZ2lzdHJ5RW50cnlbXT4oXG4gICAgXCJfZW50aXR5UmVnaXN0cnlcIixcbiAgICBmZXRjaEVudGl0eVJlZ2lzdHJ5LFxuICAgIHN1YnNjcmliZUVudGl0eVJlZ2lzdHJ5VXBkYXRlcyxcbiAgICBjb25uLFxuICAgIG9uQ2hhbmdlXG4gICk7XG5cbmV4cG9ydCBjb25zdCBzb3J0RW50aXR5UmVnaXN0cnlCeU5hbWUgPSAoZW50cmllczogRW50aXR5UmVnaXN0cnlFbnRyeVtdKSA9PlxuICBlbnRyaWVzLnNvcnQoKGVudHJ5MSwgZW50cnkyKSA9PlxuICAgIGNhc2VJbnNlbnNpdGl2ZVN0cmluZ0NvbXBhcmUoZW50cnkxLm5hbWUgfHwgXCJcIiwgZW50cnkyLm5hbWUgfHwgXCJcIilcbiAgKTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/data/entity_registry.ts\n");

/***/ }),

/***/ "./src/data/history.ts":
/*!*****************************!*\
  !*** ./src/data/history.ts ***!
  \*****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__) => {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"entityIdHistoryNeedsAttributes\": () => (/* binding */ entityIdHistoryNeedsAttributes),\n/* harmony export */   \"fetchRecent\": () => (/* binding */ fetchRecent),\n/* harmony export */   \"fetchDate\": () => (/* binding */ fetchDate),\n/* harmony export */   \"computeHistory\": () => (/* binding */ computeHistory),\n/* harmony export */   \"getStatisticIds\": () => (/* binding */ getStatisticIds),\n/* harmony export */   \"getStatisticMetadata\": () => (/* binding */ getStatisticMetadata),\n/* harmony export */   \"fetchStatistics\": () => (/* binding */ fetchStatistics),\n/* harmony export */   \"validateStatistics\": () => (/* binding */ validateStatistics),\n/* harmony export */   \"updateStatisticsMetadata\": () => (/* binding */ updateStatisticsMetadata),\n/* harmony export */   \"clearStatistics\": () => (/* binding */ clearStatistics),\n/* harmony export */   \"calculateStatisticSumGrowth\": () => (/* binding */ calculateStatisticSumGrowth),\n/* harmony export */   \"calculateStatisticsSumGrowth\": () => (/* binding */ calculateStatisticsSumGrowth),\n/* harmony export */   \"statisticsHaveType\": () => (/* binding */ statisticsHaveType),\n/* harmony export */   \"adjustStatisticsSum\": () => (/* binding */ adjustStatisticsSum)\n/* harmony export */ });\n/* harmony import */ var _common_entity_compute_domain__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../common/entity/compute_domain */ \"./src/common/entity/compute_domain.ts\");\n/* harmony import */ var _common_entity_compute_state_display__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../common/entity/compute_state_display */ \"./src/common/entity/compute_state_display.ts\");\n/* harmony import */ var _common_entity_compute_state_domain__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../common/entity/compute_state_domain */ \"./src/common/entity/compute_state_domain.ts\");\n/* harmony import */ var _common_entity_compute_state_name__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../common/entity/compute_state_name */ \"./src/common/entity/compute_state_name.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_common_entity_compute_state_display__WEBPACK_IMPORTED_MODULE_1__]);\n_common_entity_compute_state_display__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? await __webpack_async_dependencies__ : __webpack_async_dependencies__)[0];\n\n\n\n\nconst DOMAINS_USE_LAST_UPDATED = [\"climate\", \"humidifier\", \"water_heater\"];\nconst NEED_ATTRIBUTE_DOMAINS = [\"climate\", \"humidifier\", \"input_datetime\", \"thermostat\", \"water_heater\"];\nconst LINE_ATTRIBUTES_TO_KEEP = [\"temperature\", \"current_temperature\", \"target_temp_low\", \"target_temp_high\", \"hvac_action\", \"humidity\", \"mode\"];\nconst entityIdHistoryNeedsAttributes = (hass, entityId) => !hass.states[entityId] || NEED_ATTRIBUTE_DOMAINS.includes((0,_common_entity_compute_domain__WEBPACK_IMPORTED_MODULE_0__.computeDomain)(entityId));\nconst fetchRecent = (hass, entityId, startTime, endTime, skipInitialState = false, significantChangesOnly, minimalResponse = true, noAttributes) => {\n  let url = \"history/period\";\n\n  if (startTime) {\n    url += \"/\" + startTime.toISOString();\n  }\n\n  url += \"?filter_entity_id=\" + entityId;\n\n  if (endTime) {\n    url += \"&end_time=\" + endTime.toISOString();\n  }\n\n  if (skipInitialState) {\n    url += \"&skip_initial_state\";\n  }\n\n  if (significantChangesOnly !== undefined) {\n    url += `&significant_changes_only=${Number(significantChangesOnly)}`;\n  }\n\n  if (minimalResponse) {\n    url += \"&minimal_response\";\n  }\n\n  if (noAttributes) {\n    url += \"&no_attributes\";\n  }\n\n  return hass.callApi(\"GET\", url);\n};\nconst fetchDate = (hass, startTime, endTime, entityId) => hass.callApi(\"GET\", `history/period/${startTime.toISOString()}?end_time=${endTime.toISOString()}&minimal_response${entityId ? `&filter_entity_id=${entityId}` : ``}${entityId && !entityIdHistoryNeedsAttributes(hass, entityId) ? `&no_attributes` : ``}`);\n\nconst equalState = (obj1, obj2) => obj1.state === obj2.state && (!obj1.attributes || !obj2.attributes || LINE_ATTRIBUTES_TO_KEEP.every(attr => obj1.attributes[attr] === obj2.attributes[attr]));\n\nconst processTimelineEntity = (localize, language, states) => {\n  const data = [];\n  const last_element = states.length - 1;\n\n  for (const state of states) {\n    if (data.length > 0 && state.state === data[data.length - 1].state) {\n      continue;\n    } // Copy the data from the last element as its the newest\n    // and is only needed to localize the data\n\n\n    if (!state.entity_id) {\n      state.attributes = states[last_element].attributes;\n      state.entity_id = states[last_element].entity_id;\n    }\n\n    data.push({\n      state_localize: (0,_common_entity_compute_state_display__WEBPACK_IMPORTED_MODULE_1__.computeStateDisplay)(localize, state, language),\n      state: state.state,\n      last_changed: state.last_changed\n    });\n  }\n\n  return {\n    name: (0,_common_entity_compute_state_name__WEBPACK_IMPORTED_MODULE_3__.computeStateName)(states[0]),\n    entity_id: states[0].entity_id,\n    data\n  };\n};\n\nconst processLineChartEntities = (unit, entities) => {\n  const data = [];\n\n  for (const states of entities) {\n    const last = states[states.length - 1];\n    const domain = (0,_common_entity_compute_state_domain__WEBPACK_IMPORTED_MODULE_2__.computeStateDomain)(last);\n    const processedStates = [];\n\n    for (const state of states) {\n      let processedState;\n\n      if (DOMAINS_USE_LAST_UPDATED.includes(domain)) {\n        processedState = {\n          state: state.state,\n          last_changed: state.last_updated,\n          attributes: {}\n        };\n\n        for (const attr of LINE_ATTRIBUTES_TO_KEEP) {\n          if (attr in state.attributes) {\n            processedState.attributes[attr] = state.attributes[attr];\n          }\n        }\n      } else {\n        processedState = state;\n      }\n\n      if (processedStates.length > 1 && equalState(processedState, processedStates[processedStates.length - 1]) && equalState(processedState, processedStates[processedStates.length - 2])) {\n        continue;\n      }\n\n      processedStates.push(processedState);\n    }\n\n    data.push({\n      domain,\n      name: (0,_common_entity_compute_state_name__WEBPACK_IMPORTED_MODULE_3__.computeStateName)(last),\n      entity_id: last.entity_id,\n      states: processedStates\n    });\n  }\n\n  return {\n    unit,\n    identifier: entities.map(states => states[0].entity_id).join(\"\"),\n    data\n  };\n};\n\nconst stateUsesUnits = state => \"unit_of_measurement\" in state.attributes || \"state_class\" in state.attributes;\n\nconst computeHistory = (hass, stateHistory, localize) => {\n  const lineChartDevices = {};\n  const timelineDevices = [];\n\n  if (!stateHistory) {\n    return {\n      line: [],\n      timeline: []\n    };\n  }\n\n  stateHistory.forEach(stateInfo => {\n    if (stateInfo.length === 0) {\n      return;\n    }\n\n    const entityId = stateInfo[0].entity_id;\n    const currentState = entityId in hass.states ? hass.states[entityId] : undefined;\n    const stateWithUnitorStateClass = !currentState && stateInfo.find(state => state.attributes && stateUsesUnits(state));\n    let unit;\n\n    if (currentState && stateUsesUnits(currentState)) {\n      unit = currentState.attributes.unit_of_measurement || \" \";\n    } else if (stateWithUnitorStateClass) {\n      unit = stateWithUnitorStateClass.attributes.unit_of_measurement || \" \";\n    } else {\n      unit = {\n        climate: hass.config.unit_system.temperature,\n        counter: \"#\",\n        humidifier: \"%\",\n        input_number: \"#\",\n        number: \"#\",\n        water_heater: hass.config.unit_system.temperature\n      }[(0,_common_entity_compute_domain__WEBPACK_IMPORTED_MODULE_0__.computeDomain)(entityId)];\n    }\n\n    if (!unit) {\n      timelineDevices.push(processTimelineEntity(localize, hass.locale, stateInfo));\n    } else if (unit in lineChartDevices) {\n      lineChartDevices[unit].push(stateInfo);\n    } else {\n      lineChartDevices[unit] = [stateInfo];\n    }\n  });\n  const unitStates = Object.keys(lineChartDevices).map(unit => processLineChartEntities(unit, lineChartDevices[unit]));\n  return {\n    line: unitStates,\n    timeline: timelineDevices\n  };\n}; // Statistics\n\nconst getStatisticIds = (hass, statistic_type) => hass.callWS({\n  type: \"history/list_statistic_ids\",\n  statistic_type\n});\nconst getStatisticMetadata = (hass, statistic_ids) => hass.callWS({\n  type: \"recorder/get_statistics_metadata\",\n  statistic_ids\n});\nconst fetchStatistics = (hass, startTime, endTime, statistic_ids, period = \"hour\") => hass.callWS({\n  type: \"history/statistics_during_period\",\n  start_time: startTime.toISOString(),\n  end_time: endTime === null || endTime === void 0 ? void 0 : endTime.toISOString(),\n  statistic_ids,\n  period\n});\nconst validateStatistics = hass => hass.callWS({\n  type: \"recorder/validate_statistics\"\n});\nconst updateStatisticsMetadata = (hass, statistic_id, unit_of_measurement) => hass.callWS({\n  type: \"recorder/update_statistics_metadata\",\n  statistic_id,\n  unit_of_measurement\n});\nconst clearStatistics = (hass, statistic_ids) => hass.callWS({\n  type: \"recorder/clear_statistics\",\n  statistic_ids\n});\nconst calculateStatisticSumGrowth = values => {\n  if (!values || values.length < 2) {\n    return null;\n  }\n\n  const endSum = values[values.length - 1].sum;\n\n  if (endSum === null) {\n    return null;\n  }\n\n  const startSum = values[0].sum;\n\n  if (startSum === null) {\n    return endSum;\n  }\n\n  return endSum - startSum;\n};\nconst calculateStatisticsSumGrowth = (data, stats) => {\n  let totalGrowth = null;\n\n  for (const stat of stats) {\n    if (!(stat in data)) {\n      continue;\n    }\n\n    const statGrowth = calculateStatisticSumGrowth(data[stat]);\n\n    if (statGrowth === null) {\n      continue;\n    }\n\n    if (totalGrowth === null) {\n      totalGrowth = statGrowth;\n    } else {\n      totalGrowth += statGrowth;\n    }\n  }\n\n  return totalGrowth;\n};\nconst statisticsHaveType = (stats, type) => stats.some(stat => stat[type] !== null);\nconst adjustStatisticsSum = (hass, statistic_id, start_time, adjustment) => hass.callWS({\n  type: \"recorder/adjust_sum_statistics\",\n  statistic_id,\n  start_time,\n  adjustment\n});\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvZGF0YS9oaXN0b3J5LnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQU9BO0FBOEhBO0FBT0E7QUFVQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBRUE7O0FBaUJBOztBQVdBO0FBS0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUdBOzs7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBOztBQUVBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7O0FBTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQVFBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSkE7QUFNQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7O0FBRUE7O0FBSUE7QUFLQTtBQUNBOztBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFOQTtBQVFBOztBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBSUE7QUFLQTtBQUNBO0FBRkE7QUFLQTtBQUtBO0FBQ0E7QUFGQTtBQUtBO0FBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBUUE7QUFFQTtBQURBO0FBSUE7QUFNQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBRUE7QUFDQTtBQUZBO0FBS0E7QUFHQTtBQUNBO0FBQ0E7O0FBQ0E7O0FBQ0E7QUFDQTtBQUNBOztBQUNBOztBQUNBO0FBQ0E7QUFDQTs7QUFDQTtBQUNBO0FBRUE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUtBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFKQSIsInNvdXJjZXMiOlsid2VicGFjazovL2hvbWUtYXNzaXN0YW50LWZyb250ZW5kLy4vc3JjL2RhdGEvaGlzdG9yeS50cz80YTUyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEhhc3NFbnRpdHkgfSBmcm9tIFwiaG9tZS1hc3Npc3RhbnQtanMtd2Vic29ja2V0XCI7XG5pbXBvcnQgeyBjb21wdXRlRG9tYWluIH0gZnJvbSBcIi4uL2NvbW1vbi9lbnRpdHkvY29tcHV0ZV9kb21haW5cIjtcbmltcG9ydCB7IGNvbXB1dGVTdGF0ZURpc3BsYXkgfSBmcm9tIFwiLi4vY29tbW9uL2VudGl0eS9jb21wdXRlX3N0YXRlX2Rpc3BsYXlcIjtcbmltcG9ydCB7IGNvbXB1dGVTdGF0ZURvbWFpbiB9IGZyb20gXCIuLi9jb21tb24vZW50aXR5L2NvbXB1dGVfc3RhdGVfZG9tYWluXCI7XG5pbXBvcnQgeyBjb21wdXRlU3RhdGVOYW1lIH0gZnJvbSBcIi4uL2NvbW1vbi9lbnRpdHkvY29tcHV0ZV9zdGF0ZV9uYW1lXCI7XG5pbXBvcnQgeyBMb2NhbGl6ZUZ1bmMgfSBmcm9tIFwiLi4vY29tbW9uL3RyYW5zbGF0aW9ucy9sb2NhbGl6ZVwiO1xuaW1wb3J0IHsgSG9tZUFzc2lzdGFudCB9IGZyb20gXCIuLi90eXBlc1wiO1xuaW1wb3J0IHsgRnJvbnRlbmRMb2NhbGVEYXRhIH0gZnJvbSBcIi4vdHJhbnNsYXRpb25cIjtcblxuY29uc3QgRE9NQUlOU19VU0VfTEFTVF9VUERBVEVEID0gW1wiY2xpbWF0ZVwiLCBcImh1bWlkaWZpZXJcIiwgXCJ3YXRlcl9oZWF0ZXJcIl07XG5jb25zdCBORUVEX0FUVFJJQlVURV9ET01BSU5TID0gW1xuICBcImNsaW1hdGVcIixcbiAgXCJodW1pZGlmaWVyXCIsXG4gIFwiaW5wdXRfZGF0ZXRpbWVcIixcbiAgXCJ0aGVybW9zdGF0XCIsXG4gIFwid2F0ZXJfaGVhdGVyXCIsXG5dO1xuY29uc3QgTElORV9BVFRSSUJVVEVTX1RPX0tFRVAgPSBbXG4gIFwidGVtcGVyYXR1cmVcIixcbiAgXCJjdXJyZW50X3RlbXBlcmF0dXJlXCIsXG4gIFwidGFyZ2V0X3RlbXBfbG93XCIsXG4gIFwidGFyZ2V0X3RlbXBfaGlnaFwiLFxuICBcImh2YWNfYWN0aW9uXCIsXG4gIFwiaHVtaWRpdHlcIixcbiAgXCJtb2RlXCIsXG5dO1xuXG5leHBvcnQgaW50ZXJmYWNlIExpbmVDaGFydFN0YXRlIHtcbiAgc3RhdGU6IHN0cmluZztcbiAgbGFzdF9jaGFuZ2VkOiBzdHJpbmc7XG4gIGF0dHJpYnV0ZXM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIExpbmVDaGFydEVudGl0eSB7XG4gIGRvbWFpbjogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIGVudGl0eV9pZDogc3RyaW5nO1xuICBzdGF0ZXM6IExpbmVDaGFydFN0YXRlW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGluZUNoYXJ0VW5pdCB7XG4gIHVuaXQ6IHN0cmluZztcbiAgaWRlbnRpZmllcjogc3RyaW5nO1xuICBkYXRhOiBMaW5lQ2hhcnRFbnRpdHlbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUaW1lbGluZVN0YXRlIHtcbiAgc3RhdGVfbG9jYWxpemU6IHN0cmluZztcbiAgc3RhdGU6IHN0cmluZztcbiAgbGFzdF9jaGFuZ2VkOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGltZWxpbmVFbnRpdHkge1xuICBuYW1lOiBzdHJpbmc7XG4gIGVudGl0eV9pZDogc3RyaW5nO1xuICBkYXRhOiBUaW1lbGluZVN0YXRlW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSGlzdG9yeVJlc3VsdCB7XG4gIGxpbmU6IExpbmVDaGFydFVuaXRbXTtcbiAgdGltZWxpbmU6IFRpbWVsaW5lRW50aXR5W107XG59XG5cbmV4cG9ydCB0eXBlIFN0YXRpc3RpY1R5cGUgPSBcInN1bVwiIHwgXCJtaW5cIiB8IFwibWF4XCIgfCBcIm1lYW5cIjtcblxuZXhwb3J0IGludGVyZmFjZSBTdGF0aXN0aWNzIHtcbiAgW3N0YXRpc3RpY0lkOiBzdHJpbmddOiBTdGF0aXN0aWNWYWx1ZVtdO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN0YXRpc3RpY1ZhbHVlIHtcbiAgc3RhdGlzdGljX2lkOiBzdHJpbmc7XG4gIHN0YXJ0OiBzdHJpbmc7XG4gIGVuZDogc3RyaW5nO1xuICBsYXN0X3Jlc2V0OiBzdHJpbmcgfCBudWxsO1xuICBtYXg6IG51bWJlciB8IG51bGw7XG4gIG1lYW46IG51bWJlciB8IG51bGw7XG4gIG1pbjogbnVtYmVyIHwgbnVsbDtcbiAgc3VtOiBudW1iZXIgfCBudWxsO1xuICBzdGF0ZTogbnVtYmVyIHwgbnVsbDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGF0aXN0aWNzTWV0YURhdGEge1xuICB1bml0X29mX21lYXN1cmVtZW50OiBzdHJpbmc7XG4gIHN0YXRpc3RpY19pZDogc3RyaW5nO1xuICBzb3VyY2U6IHN0cmluZztcbiAgbmFtZT86IHN0cmluZyB8IG51bGw7XG4gIGhhc19zdW06IGJvb2xlYW47XG4gIGhhc19tZWFuOiBib29sZWFuO1xufVxuXG5leHBvcnQgdHlwZSBTdGF0aXN0aWNzVmFsaWRhdGlvblJlc3VsdCA9XG4gIHwgU3RhdGlzdGljc1ZhbGlkYXRpb25SZXN1bHROb1N0YXRlXG4gIHwgU3RhdGlzdGljc1ZhbGlkYXRpb25SZXN1bHRFbnRpdHlOb3RSZWNvcmRlZFxuICB8IFN0YXRpc3RpY3NWYWxpZGF0aW9uUmVzdWx0RW50aXR5Tm9Mb25nZXJSZWNvcmRlZFxuICB8IFN0YXRpc3RpY3NWYWxpZGF0aW9uUmVzdWx0VW5zdXBwb3J0ZWRTdGF0ZUNsYXNzXG4gIHwgU3RhdGlzdGljc1ZhbGlkYXRpb25SZXN1bHRVbml0c0NoYW5nZWRcbiAgfCBTdGF0aXN0aWNzVmFsaWRhdGlvblJlc3VsdFVuc3VwcG9ydGVkVW5pdE1ldGFkYXRhXG4gIHwgU3RhdGlzdGljc1ZhbGlkYXRpb25SZXN1bHRVbnN1cHBvcnRlZFVuaXRTdGF0ZTtcblxuZXhwb3J0IGludGVyZmFjZSBTdGF0aXN0aWNzVmFsaWRhdGlvblJlc3VsdE5vU3RhdGUge1xuICB0eXBlOiBcIm5vX3N0YXRlXCI7XG4gIGRhdGE6IHsgc3RhdGlzdGljX2lkOiBzdHJpbmcgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGF0aXN0aWNzVmFsaWRhdGlvblJlc3VsdEVudGl0eU5vTG9uZ2VyUmVjb3JkZWQge1xuICB0eXBlOiBcImVudGl0eV9ub19sb25nZXJfcmVjb3JkZWRcIjtcbiAgZGF0YTogeyBzdGF0aXN0aWNfaWQ6IHN0cmluZyB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN0YXRpc3RpY3NWYWxpZGF0aW9uUmVzdWx0RW50aXR5Tm90UmVjb3JkZWQge1xuICB0eXBlOiBcImVudGl0eV9ub3RfcmVjb3JkZWRcIjtcbiAgZGF0YTogeyBzdGF0aXN0aWNfaWQ6IHN0cmluZyB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN0YXRpc3RpY3NWYWxpZGF0aW9uUmVzdWx0VW5zdXBwb3J0ZWRTdGF0ZUNsYXNzIHtcbiAgdHlwZTogXCJ1bnN1cHBvcnRlZF9zdGF0ZV9jbGFzc1wiO1xuICBkYXRhOiB7IHN0YXRpc3RpY19pZDogc3RyaW5nOyBzdGF0ZV9jbGFzczogc3RyaW5nIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU3RhdGlzdGljc1ZhbGlkYXRpb25SZXN1bHRVbml0c0NoYW5nZWQge1xuICB0eXBlOiBcInVuaXRzX2NoYW5nZWRcIjtcbiAgZGF0YTogeyBzdGF0aXN0aWNfaWQ6IHN0cmluZzsgc3RhdGVfdW5pdDogc3RyaW5nOyBtZXRhZGF0YV91bml0OiBzdHJpbmcgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGF0aXN0aWNzVmFsaWRhdGlvblJlc3VsdFVuc3VwcG9ydGVkVW5pdE1ldGFkYXRhIHtcbiAgdHlwZTogXCJ1bnN1cHBvcnRlZF91bml0X21ldGFkYXRhXCI7XG4gIGRhdGE6IHtcbiAgICBzdGF0aXN0aWNfaWQ6IHN0cmluZztcbiAgICBkZXZpY2VfY2xhc3M6IHN0cmluZztcbiAgICBtZXRhZGF0YV91bml0OiBzdHJpbmc7XG4gICAgc3VwcG9ydGVkX3VuaXQ6IHN0cmluZztcbiAgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGF0aXN0aWNzVmFsaWRhdGlvblJlc3VsdFVuc3VwcG9ydGVkVW5pdFN0YXRlIHtcbiAgdHlwZTogXCJ1bnN1cHBvcnRlZF91bml0X3N0YXRlXCI7XG4gIGRhdGE6IHsgc3RhdGlzdGljX2lkOiBzdHJpbmc7IGRldmljZV9jbGFzczogc3RyaW5nOyBtZXRhZGF0YV91bml0OiBzdHJpbmcgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdGF0aXN0aWNzVmFsaWRhdGlvblJlc3VsdHMge1xuICBbc3RhdGlzdGljSWQ6IHN0cmluZ106IFN0YXRpc3RpY3NWYWxpZGF0aW9uUmVzdWx0W107XG59XG5cbmV4cG9ydCBjb25zdCBlbnRpdHlJZEhpc3RvcnlOZWVkc0F0dHJpYnV0ZXMgPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIGVudGl0eUlkOiBzdHJpbmdcbikgPT5cbiAgIWhhc3Muc3RhdGVzW2VudGl0eUlkXSB8fFxuICBORUVEX0FUVFJJQlVURV9ET01BSU5TLmluY2x1ZGVzKGNvbXB1dGVEb21haW4oZW50aXR5SWQpKTtcblxuZXhwb3J0IGNvbnN0IGZldGNoUmVjZW50ID0gKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBlbnRpdHlJZDogc3RyaW5nLFxuICBzdGFydFRpbWU6IERhdGUsXG4gIGVuZFRpbWU6IERhdGUsXG4gIHNraXBJbml0aWFsU3RhdGUgPSBmYWxzZSxcbiAgc2lnbmlmaWNhbnRDaGFuZ2VzT25seT86IGJvb2xlYW4sXG4gIG1pbmltYWxSZXNwb25zZSA9IHRydWUsXG4gIG5vQXR0cmlidXRlcz86IGJvb2xlYW5cbik6IFByb21pc2U8SGFzc0VudGl0eVtdW10+ID0+IHtcbiAgbGV0IHVybCA9IFwiaGlzdG9yeS9wZXJpb2RcIjtcbiAgaWYgKHN0YXJ0VGltZSkge1xuICAgIHVybCArPSBcIi9cIiArIHN0YXJ0VGltZS50b0lTT1N0cmluZygpO1xuICB9XG4gIHVybCArPSBcIj9maWx0ZXJfZW50aXR5X2lkPVwiICsgZW50aXR5SWQ7XG4gIGlmIChlbmRUaW1lKSB7XG4gICAgdXJsICs9IFwiJmVuZF90aW1lPVwiICsgZW5kVGltZS50b0lTT1N0cmluZygpO1xuICB9XG4gIGlmIChza2lwSW5pdGlhbFN0YXRlKSB7XG4gICAgdXJsICs9IFwiJnNraXBfaW5pdGlhbF9zdGF0ZVwiO1xuICB9XG4gIGlmIChzaWduaWZpY2FudENoYW5nZXNPbmx5ICE9PSB1bmRlZmluZWQpIHtcbiAgICB1cmwgKz0gYCZzaWduaWZpY2FudF9jaGFuZ2VzX29ubHk9JHtOdW1iZXIoc2lnbmlmaWNhbnRDaGFuZ2VzT25seSl9YDtcbiAgfVxuICBpZiAobWluaW1hbFJlc3BvbnNlKSB7XG4gICAgdXJsICs9IFwiJm1pbmltYWxfcmVzcG9uc2VcIjtcbiAgfVxuICBpZiAobm9BdHRyaWJ1dGVzKSB7XG4gICAgdXJsICs9IFwiJm5vX2F0dHJpYnV0ZXNcIjtcbiAgfVxuICByZXR1cm4gaGFzcy5jYWxsQXBpKFwiR0VUXCIsIHVybCk7XG59O1xuXG5leHBvcnQgY29uc3QgZmV0Y2hEYXRlID0gKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBzdGFydFRpbWU6IERhdGUsXG4gIGVuZFRpbWU6IERhdGUsXG4gIGVudGl0eUlkPzogc3RyaW5nXG4pOiBQcm9taXNlPEhhc3NFbnRpdHlbXVtdPiA9PlxuICBoYXNzLmNhbGxBcGkoXG4gICAgXCJHRVRcIixcbiAgICBgaGlzdG9yeS9wZXJpb2QvJHtzdGFydFRpbWUudG9JU09TdHJpbmcoKX0/ZW5kX3RpbWU9JHtlbmRUaW1lLnRvSVNPU3RyaW5nKCl9Jm1pbmltYWxfcmVzcG9uc2Uke1xuICAgICAgZW50aXR5SWQgPyBgJmZpbHRlcl9lbnRpdHlfaWQ9JHtlbnRpdHlJZH1gIDogYGBcbiAgICB9JHtcbiAgICAgIGVudGl0eUlkICYmICFlbnRpdHlJZEhpc3RvcnlOZWVkc0F0dHJpYnV0ZXMoaGFzcywgZW50aXR5SWQpXG4gICAgICAgID8gYCZub19hdHRyaWJ1dGVzYFxuICAgICAgICA6IGBgXG4gICAgfWBcbiAgKTtcblxuY29uc3QgZXF1YWxTdGF0ZSA9IChvYmoxOiBMaW5lQ2hhcnRTdGF0ZSwgb2JqMjogTGluZUNoYXJ0U3RhdGUpID0+XG4gIG9iajEuc3RhdGUgPT09IG9iajIuc3RhdGUgJiZcbiAgLy8gT25seSBjb21wYXJlIGF0dHJpYnV0ZXMgaWYgYm90aCBzdGF0ZXMgaGF2ZSBhbiBhdHRyaWJ1dGVzIG9iamVjdC5cbiAgLy8gV2hlbiBgbWluaW1hbF9yZXNwb25zZWAgaXMgc2VudCwgb25seSB0aGUgZmlyc3QgYW5kIGxhc3Qgc3RhdGVcbiAgLy8gd2lsbCBoYXZlIGF0dHJpYnV0ZXMgZXhjZXB0IGZvciBkb21haW5zIGluIERPTUFJTlNfVVNFX0xBU1RfVVBEQVRFRC5cbiAgKCFvYmoxLmF0dHJpYnV0ZXMgfHxcbiAgICAhb2JqMi5hdHRyaWJ1dGVzIHx8XG4gICAgTElORV9BVFRSSUJVVEVTX1RPX0tFRVAuZXZlcnkoXG4gICAgICAoYXR0cikgPT4gb2JqMS5hdHRyaWJ1dGVzIVthdHRyXSA9PT0gb2JqMi5hdHRyaWJ1dGVzIVthdHRyXVxuICAgICkpO1xuXG5jb25zdCBwcm9jZXNzVGltZWxpbmVFbnRpdHkgPSAoXG4gIGxvY2FsaXplOiBMb2NhbGl6ZUZ1bmMsXG4gIGxhbmd1YWdlOiBGcm9udGVuZExvY2FsZURhdGEsXG4gIHN0YXRlczogSGFzc0VudGl0eVtdXG4pOiBUaW1lbGluZUVudGl0eSA9PiB7XG4gIGNvbnN0IGRhdGE6IFRpbWVsaW5lU3RhdGVbXSA9IFtdO1xuICBjb25zdCBsYXN0X2VsZW1lbnQgPSBzdGF0ZXMubGVuZ3RoIC0gMTtcblxuICBmb3IgKGNvbnN0IHN0YXRlIG9mIHN0YXRlcykge1xuICAgIGlmIChkYXRhLmxlbmd0aCA+IDAgJiYgc3RhdGUuc3RhdGUgPT09IGRhdGFbZGF0YS5sZW5ndGggLSAxXS5zdGF0ZSkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgLy8gQ29weSB0aGUgZGF0YSBmcm9tIHRoZSBsYXN0IGVsZW1lbnQgYXMgaXRzIHRoZSBuZXdlc3RcbiAgICAvLyBhbmQgaXMgb25seSBuZWVkZWQgdG8gbG9jYWxpemUgdGhlIGRhdGFcbiAgICBpZiAoIXN0YXRlLmVudGl0eV9pZCkge1xuICAgICAgc3RhdGUuYXR0cmlidXRlcyA9IHN0YXRlc1tsYXN0X2VsZW1lbnRdLmF0dHJpYnV0ZXM7XG4gICAgICBzdGF0ZS5lbnRpdHlfaWQgPSBzdGF0ZXNbbGFzdF9lbGVtZW50XS5lbnRpdHlfaWQ7XG4gICAgfVxuXG4gICAgZGF0YS5wdXNoKHtcbiAgICAgIHN0YXRlX2xvY2FsaXplOiBjb21wdXRlU3RhdGVEaXNwbGF5KGxvY2FsaXplLCBzdGF0ZSwgbGFuZ3VhZ2UpLFxuICAgICAgc3RhdGU6IHN0YXRlLnN0YXRlLFxuICAgICAgbGFzdF9jaGFuZ2VkOiBzdGF0ZS5sYXN0X2NoYW5nZWQsXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIG5hbWU6IGNvbXB1dGVTdGF0ZU5hbWUoc3RhdGVzWzBdKSxcbiAgICBlbnRpdHlfaWQ6IHN0YXRlc1swXS5lbnRpdHlfaWQsXG4gICAgZGF0YSxcbiAgfTtcbn07XG5cbmNvbnN0IHByb2Nlc3NMaW5lQ2hhcnRFbnRpdGllcyA9IChcbiAgdW5pdCxcbiAgZW50aXRpZXM6IEhhc3NFbnRpdHlbXVtdXG4pOiBMaW5lQ2hhcnRVbml0ID0+IHtcbiAgY29uc3QgZGF0YTogTGluZUNoYXJ0RW50aXR5W10gPSBbXTtcblxuICBmb3IgKGNvbnN0IHN0YXRlcyBvZiBlbnRpdGllcykge1xuICAgIGNvbnN0IGxhc3Q6IEhhc3NFbnRpdHkgPSBzdGF0ZXNbc3RhdGVzLmxlbmd0aCAtIDFdO1xuICAgIGNvbnN0IGRvbWFpbiA9IGNvbXB1dGVTdGF0ZURvbWFpbihsYXN0KTtcbiAgICBjb25zdCBwcm9jZXNzZWRTdGF0ZXM6IExpbmVDaGFydFN0YXRlW10gPSBbXTtcblxuICAgIGZvciAoY29uc3Qgc3RhdGUgb2Ygc3RhdGVzKSB7XG4gICAgICBsZXQgcHJvY2Vzc2VkU3RhdGU6IExpbmVDaGFydFN0YXRlO1xuXG4gICAgICBpZiAoRE9NQUlOU19VU0VfTEFTVF9VUERBVEVELmluY2x1ZGVzKGRvbWFpbikpIHtcbiAgICAgICAgcHJvY2Vzc2VkU3RhdGUgPSB7XG4gICAgICAgICAgc3RhdGU6IHN0YXRlLnN0YXRlLFxuICAgICAgICAgIGxhc3RfY2hhbmdlZDogc3RhdGUubGFzdF91cGRhdGVkLFxuICAgICAgICAgIGF0dHJpYnV0ZXM6IHt9LFxuICAgICAgICB9O1xuXG4gICAgICAgIGZvciAoY29uc3QgYXR0ciBvZiBMSU5FX0FUVFJJQlVURVNfVE9fS0VFUCkge1xuICAgICAgICAgIGlmIChhdHRyIGluIHN0YXRlLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgIHByb2Nlc3NlZFN0YXRlLmF0dHJpYnV0ZXMhW2F0dHJdID0gc3RhdGUuYXR0cmlidXRlc1thdHRyXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHByb2Nlc3NlZFN0YXRlID0gc3RhdGU7XG4gICAgICB9XG5cbiAgICAgIGlmIChcbiAgICAgICAgcHJvY2Vzc2VkU3RhdGVzLmxlbmd0aCA+IDEgJiZcbiAgICAgICAgZXF1YWxTdGF0ZShcbiAgICAgICAgICBwcm9jZXNzZWRTdGF0ZSxcbiAgICAgICAgICBwcm9jZXNzZWRTdGF0ZXNbcHJvY2Vzc2VkU3RhdGVzLmxlbmd0aCAtIDFdXG4gICAgICAgICkgJiZcbiAgICAgICAgZXF1YWxTdGF0ZShwcm9jZXNzZWRTdGF0ZSwgcHJvY2Vzc2VkU3RhdGVzW3Byb2Nlc3NlZFN0YXRlcy5sZW5ndGggLSAyXSlcbiAgICAgICkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgcHJvY2Vzc2VkU3RhdGVzLnB1c2gocHJvY2Vzc2VkU3RhdGUpO1xuICAgIH1cblxuICAgIGRhdGEucHVzaCh7XG4gICAgICBkb21haW4sXG4gICAgICBuYW1lOiBjb21wdXRlU3RhdGVOYW1lKGxhc3QpLFxuICAgICAgZW50aXR5X2lkOiBsYXN0LmVudGl0eV9pZCxcbiAgICAgIHN0YXRlczogcHJvY2Vzc2VkU3RhdGVzLFxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB1bml0LFxuICAgIGlkZW50aWZpZXI6IGVudGl0aWVzLm1hcCgoc3RhdGVzKSA9PiBzdGF0ZXNbMF0uZW50aXR5X2lkKS5qb2luKFwiXCIpLFxuICAgIGRhdGEsXG4gIH07XG59O1xuXG5jb25zdCBzdGF0ZVVzZXNVbml0cyA9IChzdGF0ZTogSGFzc0VudGl0eSkgPT5cbiAgXCJ1bml0X29mX21lYXN1cmVtZW50XCIgaW4gc3RhdGUuYXR0cmlidXRlcyB8fFxuICBcInN0YXRlX2NsYXNzXCIgaW4gc3RhdGUuYXR0cmlidXRlcztcblxuZXhwb3J0IGNvbnN0IGNvbXB1dGVIaXN0b3J5ID0gKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBzdGF0ZUhpc3Rvcnk6IEhhc3NFbnRpdHlbXVtdLFxuICBsb2NhbGl6ZTogTG9jYWxpemVGdW5jXG4pOiBIaXN0b3J5UmVzdWx0ID0+IHtcbiAgY29uc3QgbGluZUNoYXJ0RGV2aWNlczogeyBbdW5pdDogc3RyaW5nXTogSGFzc0VudGl0eVtdW10gfSA9IHt9O1xuICBjb25zdCB0aW1lbGluZURldmljZXM6IFRpbWVsaW5lRW50aXR5W10gPSBbXTtcbiAgaWYgKCFzdGF0ZUhpc3RvcnkpIHtcbiAgICByZXR1cm4geyBsaW5lOiBbXSwgdGltZWxpbmU6IFtdIH07XG4gIH1cblxuICBzdGF0ZUhpc3RvcnkuZm9yRWFjaCgoc3RhdGVJbmZvKSA9PiB7XG4gICAgaWYgKHN0YXRlSW5mby5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBlbnRpdHlJZCA9IHN0YXRlSW5mb1swXS5lbnRpdHlfaWQ7XG4gICAgY29uc3QgY3VycmVudFN0YXRlID1cbiAgICAgIGVudGl0eUlkIGluIGhhc3Muc3RhdGVzID8gaGFzcy5zdGF0ZXNbZW50aXR5SWRdIDogdW5kZWZpbmVkO1xuICAgIGNvbnN0IHN0YXRlV2l0aFVuaXRvclN0YXRlQ2xhc3MgPVxuICAgICAgIWN1cnJlbnRTdGF0ZSAmJlxuICAgICAgc3RhdGVJbmZvLmZpbmQoKHN0YXRlKSA9PiBzdGF0ZS5hdHRyaWJ1dGVzICYmIHN0YXRlVXNlc1VuaXRzKHN0YXRlKSk7XG5cbiAgICBsZXQgdW5pdDogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gICAgaWYgKGN1cnJlbnRTdGF0ZSAmJiBzdGF0ZVVzZXNVbml0cyhjdXJyZW50U3RhdGUpKSB7XG4gICAgICB1bml0ID0gY3VycmVudFN0YXRlLmF0dHJpYnV0ZXMudW5pdF9vZl9tZWFzdXJlbWVudCB8fCBcIiBcIjtcbiAgICB9IGVsc2UgaWYgKHN0YXRlV2l0aFVuaXRvclN0YXRlQ2xhc3MpIHtcbiAgICAgIHVuaXQgPSBzdGF0ZVdpdGhVbml0b3JTdGF0ZUNsYXNzLmF0dHJpYnV0ZXMudW5pdF9vZl9tZWFzdXJlbWVudCB8fCBcIiBcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdW5pdCA9IHtcbiAgICAgICAgY2xpbWF0ZTogaGFzcy5jb25maWcudW5pdF9zeXN0ZW0udGVtcGVyYXR1cmUsXG4gICAgICAgIGNvdW50ZXI6IFwiI1wiLFxuICAgICAgICBodW1pZGlmaWVyOiBcIiVcIixcbiAgICAgICAgaW5wdXRfbnVtYmVyOiBcIiNcIixcbiAgICAgICAgbnVtYmVyOiBcIiNcIixcbiAgICAgICAgd2F0ZXJfaGVhdGVyOiBoYXNzLmNvbmZpZy51bml0X3N5c3RlbS50ZW1wZXJhdHVyZSxcbiAgICAgIH1bY29tcHV0ZURvbWFpbihlbnRpdHlJZCldO1xuICAgIH1cblxuICAgIGlmICghdW5pdCkge1xuICAgICAgdGltZWxpbmVEZXZpY2VzLnB1c2goXG4gICAgICAgIHByb2Nlc3NUaW1lbGluZUVudGl0eShsb2NhbGl6ZSwgaGFzcy5sb2NhbGUsIHN0YXRlSW5mbylcbiAgICAgICk7XG4gICAgfSBlbHNlIGlmICh1bml0IGluIGxpbmVDaGFydERldmljZXMpIHtcbiAgICAgIGxpbmVDaGFydERldmljZXNbdW5pdF0ucHVzaChzdGF0ZUluZm8pO1xuICAgIH0gZWxzZSB7XG4gICAgICBsaW5lQ2hhcnREZXZpY2VzW3VuaXRdID0gW3N0YXRlSW5mb107XG4gICAgfVxuICB9KTtcblxuICBjb25zdCB1bml0U3RhdGVzID0gT2JqZWN0LmtleXMobGluZUNoYXJ0RGV2aWNlcykubWFwKCh1bml0KSA9PlxuICAgIHByb2Nlc3NMaW5lQ2hhcnRFbnRpdGllcyh1bml0LCBsaW5lQ2hhcnREZXZpY2VzW3VuaXRdKVxuICApO1xuXG4gIHJldHVybiB7IGxpbmU6IHVuaXRTdGF0ZXMsIHRpbWVsaW5lOiB0aW1lbGluZURldmljZXMgfTtcbn07XG5cbi8vIFN0YXRpc3RpY3NcblxuZXhwb3J0IGNvbnN0IGdldFN0YXRpc3RpY0lkcyA9IChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgc3RhdGlzdGljX3R5cGU/OiBcIm1lYW5cIiB8IFwic3VtXCJcbikgPT5cbiAgaGFzcy5jYWxsV1M8U3RhdGlzdGljc01ldGFEYXRhW10+KHtcbiAgICB0eXBlOiBcImhpc3RvcnkvbGlzdF9zdGF0aXN0aWNfaWRzXCIsXG4gICAgc3RhdGlzdGljX3R5cGUsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgZ2V0U3RhdGlzdGljTWV0YWRhdGEgPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIHN0YXRpc3RpY19pZHM/OiBzdHJpbmdbXVxuKSA9PlxuICBoYXNzLmNhbGxXUzxTdGF0aXN0aWNzTWV0YURhdGFbXT4oe1xuICAgIHR5cGU6IFwicmVjb3JkZXIvZ2V0X3N0YXRpc3RpY3NfbWV0YWRhdGFcIixcbiAgICBzdGF0aXN0aWNfaWRzLFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IGZldGNoU3RhdGlzdGljcyA9IChcbiAgaGFzczogSG9tZUFzc2lzdGFudCxcbiAgc3RhcnRUaW1lOiBEYXRlLFxuICBlbmRUaW1lPzogRGF0ZSxcbiAgc3RhdGlzdGljX2lkcz86IHN0cmluZ1tdLFxuICBwZXJpb2Q6IFwiNW1pbnV0ZVwiIHwgXCJob3VyXCIgfCBcImRheVwiIHwgXCJtb250aFwiID0gXCJob3VyXCJcbikgPT5cbiAgaGFzcy5jYWxsV1M8U3RhdGlzdGljcz4oe1xuICAgIHR5cGU6IFwiaGlzdG9yeS9zdGF0aXN0aWNzX2R1cmluZ19wZXJpb2RcIixcbiAgICBzdGFydF90aW1lOiBzdGFydFRpbWUudG9JU09TdHJpbmcoKSxcbiAgICBlbmRfdGltZTogZW5kVGltZT8udG9JU09TdHJpbmcoKSxcbiAgICBzdGF0aXN0aWNfaWRzLFxuICAgIHBlcmlvZCxcbiAgfSk7XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0ZVN0YXRpc3RpY3MgPSAoaGFzczogSG9tZUFzc2lzdGFudCkgPT5cbiAgaGFzcy5jYWxsV1M8U3RhdGlzdGljc1ZhbGlkYXRpb25SZXN1bHRzPih7XG4gICAgdHlwZTogXCJyZWNvcmRlci92YWxpZGF0ZV9zdGF0aXN0aWNzXCIsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgdXBkYXRlU3RhdGlzdGljc01ldGFkYXRhID0gKFxuICBoYXNzOiBIb21lQXNzaXN0YW50LFxuICBzdGF0aXN0aWNfaWQ6IHN0cmluZyxcbiAgdW5pdF9vZl9tZWFzdXJlbWVudDogc3RyaW5nIHwgbnVsbFxuKSA9PlxuICBoYXNzLmNhbGxXUzx2b2lkPih7XG4gICAgdHlwZTogXCJyZWNvcmRlci91cGRhdGVfc3RhdGlzdGljc19tZXRhZGF0YVwiLFxuICAgIHN0YXRpc3RpY19pZCxcbiAgICB1bml0X29mX21lYXN1cmVtZW50LFxuICB9KTtcblxuZXhwb3J0IGNvbnN0IGNsZWFyU3RhdGlzdGljcyA9IChoYXNzOiBIb21lQXNzaXN0YW50LCBzdGF0aXN0aWNfaWRzOiBzdHJpbmdbXSkgPT5cbiAgaGFzcy5jYWxsV1M8dm9pZD4oe1xuICAgIHR5cGU6IFwicmVjb3JkZXIvY2xlYXJfc3RhdGlzdGljc1wiLFxuICAgIHN0YXRpc3RpY19pZHMsXG4gIH0pO1xuXG5leHBvcnQgY29uc3QgY2FsY3VsYXRlU3RhdGlzdGljU3VtR3Jvd3RoID0gKFxuICB2YWx1ZXM6IFN0YXRpc3RpY1ZhbHVlW11cbik6IG51bWJlciB8IG51bGwgPT4ge1xuICBpZiAoIXZhbHVlcyB8fCB2YWx1ZXMubGVuZ3RoIDwgMikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IGVuZFN1bSA9IHZhbHVlc1t2YWx1ZXMubGVuZ3RoIC0gMV0uc3VtO1xuICBpZiAoZW5kU3VtID09PSBudWxsKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3Qgc3RhcnRTdW0gPSB2YWx1ZXNbMF0uc3VtO1xuICBpZiAoc3RhcnRTdW0gPT09IG51bGwpIHtcbiAgICByZXR1cm4gZW5kU3VtO1xuICB9XG4gIHJldHVybiBlbmRTdW0gLSBzdGFydFN1bTtcbn07XG5cbmV4cG9ydCBjb25zdCBjYWxjdWxhdGVTdGF0aXN0aWNzU3VtR3Jvd3RoID0gKFxuICBkYXRhOiBTdGF0aXN0aWNzLFxuICBzdGF0czogc3RyaW5nW11cbik6IG51bWJlciB8IG51bGwgPT4ge1xuICBsZXQgdG90YWxHcm93dGg6IG51bWJlciB8IG51bGwgPSBudWxsO1xuXG4gIGZvciAoY29uc3Qgc3RhdCBvZiBzdGF0cykge1xuICAgIGlmICghKHN0YXQgaW4gZGF0YSkpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBjb25zdCBzdGF0R3Jvd3RoID0gY2FsY3VsYXRlU3RhdGlzdGljU3VtR3Jvd3RoKGRhdGFbc3RhdF0pO1xuXG4gICAgaWYgKHN0YXRHcm93dGggPT09IG51bGwpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAodG90YWxHcm93dGggPT09IG51bGwpIHtcbiAgICAgIHRvdGFsR3Jvd3RoID0gc3RhdEdyb3d0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgdG90YWxHcm93dGggKz0gc3RhdEdyb3d0aDtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdG90YWxHcm93dGg7XG59O1xuXG5leHBvcnQgY29uc3Qgc3RhdGlzdGljc0hhdmVUeXBlID0gKFxuICBzdGF0czogU3RhdGlzdGljVmFsdWVbXSxcbiAgdHlwZTogU3RhdGlzdGljVHlwZVxuKSA9PiBzdGF0cy5zb21lKChzdGF0KSA9PiBzdGF0W3R5cGVdICE9PSBudWxsKTtcblxuZXhwb3J0IGNvbnN0IGFkanVzdFN0YXRpc3RpY3NTdW0gPSAoXG4gIGhhc3M6IEhvbWVBc3Npc3RhbnQsXG4gIHN0YXRpc3RpY19pZDogc3RyaW5nLFxuICBzdGFydF90aW1lOiBzdHJpbmcsXG4gIGFkanVzdG1lbnQ6IG51bWJlclxuKTogUHJvbWlzZTx2b2lkPiA9PlxuICBoYXNzLmNhbGxXUyh7XG4gICAgdHlwZTogXCJyZWNvcmRlci9hZGp1c3Rfc3VtX3N0YXRpc3RpY3NcIixcbiAgICBzdGF0aXN0aWNfaWQsXG4gICAgc3RhcnRfdGltZSxcbiAgICBhZGp1c3RtZW50LFxuICB9KTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./src/data/history.ts\n");

/***/ })

}]);